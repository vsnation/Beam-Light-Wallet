<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BEAM Light Wallet</title>
    <link rel="icon" type="image/png" sizes="256x256" href="/icon-256.png">
    <link rel="icon" type="image/png" sizes="64x64" href="/favicon.png">
    <link rel="apple-touch-icon" sizes="192x192" href="/icon-192.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#25c2a0">
    <meta name="description" content="BEAM Light Wallet - Decentralized Privacy Wallet">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- Stylesheets (fonts loaded locally via @font-face in base.css) -->
    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/welcome.css">
    <link rel="stylesheet" href="/css/fuddle.css">

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <!-- DEX Shader (loads window.DEX_SHADER for contract calls) -->
    <script src="/js/dex-shader.js"></script>
    <!-- Airdrop Shader (loads window.AIRDROP_SHADER for airdrop contract calls) -->
    <script src="/js/airdrop-shader.js"></script>
    <!-- Fuddle Shader (loads window.FUDDLE_SHADER for Fuddle game contract calls) -->
    <script src="/js/fuddle-shader.js"></script>
</head>
<body>
    <!-- Background Effects -->
    <div class="bg-effects">
        <div class="bg-gradient bg-gradient-1"></div>
        <div class="bg-gradient bg-gradient-2"></div>
    </div>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-logo">
                <svg viewBox="0 0 40 40" fill="none">
                    <circle cx="20" cy="20" r="18" stroke="url(#logo-gradient)" stroke-width="2" fill="none"/>
                    <path d="M12 20L18 26L28 14" stroke="url(#logo-gradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    <defs>
                        <linearGradient id="logo-gradient" x1="0" y1="0" x2="40" y2="40">
                            <stop offset="0%" stop-color="#25c2a0"/>
                            <stop offset="100%" stop-color="#00d4ff"/>
                        </linearGradient>
                    </defs>
                </svg>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-item active" data-page="dashboard" data-tooltip="Dashboard">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="9" rx="1"/>
                        <rect x="14" y="3" width="7" height="5" rx="1"/>
                        <rect x="14" y="12" width="7" height="9" rx="1"/>
                        <rect x="3" y="16" width="7" height="5" rx="1"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="assets" data-tooltip="Assets">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v12M6 12h12"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="transactions" data-tooltip="Transactions">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2v20M17 7l-5-5-5 5M7 17l5 5 5-5"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="addresses" data-tooltip="Addresses">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/>
                        <circle cx="12" cy="10" r="3"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="dex" data-tooltip="DEX Trading">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="p2p" data-tooltip="P2P Trading">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="6" cy="6" r="3"/>
                        <circle cx="18" cy="18" r="3"/>
                        <path d="M6 21V9a9 9 0 009 9h6"/>
                        <path d="M18 3v12a9 9 0 01-9-9H3"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="airdrop" data-tooltip="Airdrop">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 12v10H4V12"/>
                        <path d="M2 7h20v5H2z"/>
                        <path d="M12 22V7"/>
                        <path d="M12 7H7.5a2.5 2.5 0 010-5C11 2 12 7 12 7z"/>
                        <path d="M12 7h4.5a2.5 2.5 0 000-5C13 2 12 7 12 7z"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="explorer" data-tooltip="Explorer">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="M21 21l-4.35-4.35"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="appstore" data-tooltip="App Store">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7" rx="1.5"/>
                        <rect x="14" y="3" width="7" height="7" rx="1.5"/>
                        <rect x="3" y="14" width="7" height="7" rx="1.5"/>
                        <rect x="14" y="14" width="7" height="7" rx="1.5"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="donate" data-tooltip="Support Development">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="settings" data-tooltip="Settings">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v4M12 19v4M4.2 4.2l2.8 2.8M17 17l2.8 2.8M1 12h4M19 12h4M4.2 19.8l2.8-2.8M17 7l2.8-2.8"/>
                    </svg>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="nav-item" data-tooltip="Help & Guide" onclick="showGuide()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9 9a3 3 0 015.12 2.13c0 2-3 3-3 3M12 17h.01"/>
                    </svg>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h1 class="page-title" id="page-title">Dashboard</h1>
                    <div class="network-badge">
                        <span>Mainnet</span>
                    </div>
                </div>
                <div class="header-right">
                    <a href="https://buybeam.my" target="_blank" rel="noopener" class="buy-beam-btn">
                        Buy $BEAM
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" width="14" height="14" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17L17 7M17 7H7M17 7v10"/></svg>
                    </a>
                    <button class="header-btn" onclick="openReceiveModal()" title="Receive">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M19 12l-7 7-7-7"/>
                        </svg>
                    </button>
                    <button class="header-btn" title="Notifications">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/>
                        </svg>
                    </button>
                    <button class="header-btn" id="lock-btn" title="Lock Wallet" onclick="lockWallet()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2"/>
                            <path d="M7 11V7a5 5 0 0110 0v4"/>
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Content -->
            <div class="content">
                <!-- Node Sync Banner (shown when on public node while local node syncs) -->
                <div id="node-sync-banner" class="node-sync-banner" style="display:none;">
                    <div class="node-sync-banner-inner">
                        <div class="node-sync-banner-left">
                            <div class="node-sync-pulse"></div>
                            <span class="node-sync-label" id="node-sync-banner-label">Local node syncing...</span>
                        </div>
                        <div class="node-sync-banner-right">
                            <span class="node-sync-pct" id="node-sync-banner-pct">0%</span>
                            <div class="node-sync-bar-wrap">
                                <div class="node-sync-bar-fill" id="node-sync-banner-fill" style="width:0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Dashboard Page -->
                <div class="page active" id="page-dashboard">
                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <button class="quick-btn quick-btn-primary" onclick="openSendModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 19V5M5 12l7-7 7 7"/>
                            </svg>
                            Send
                        </button>
                        <button class="quick-btn quick-btn-secondary" onclick="openReceiveModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 5v14M19 12l-7 7-7-7"/>
                            </svg>
                            Receive
                        </button>
                        <button class="quick-btn quick-btn-secondary" onclick="App.showPage('dex')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 3h5v5M4 20L21 3M21 16v5h-5"/>
                            </svg>
                            Swap
                        </button>
                    </div>

                    <!-- Assets Section -->
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">
                                Assets
                                <div class="info-trigger">
                                    ?
                                    <div class="info-panel">
                                        <div class="info-panel-title">What are Confidential Assets?</div>
                                        <div class="info-panel-text">
                                            Confidential Assets (CAs) are custom tokens on the BEAM blockchain. They inherit BEAM's privacy features, meaning all transactions are private by default. Anyone can create a CA for various purposes like tokens, stablecoins, or NFTs.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="view-toggle">
                                <span>Selected</span>
                                <div class="toggle-switch active" id="asset-toggle" onclick="toggleAssetView()"></div>
                                <span>All</span>
                            </div>
                        </div>

                        <div class="asset-cards-container">
                            <div class="asset-cards-scroll" id="asset-cards">
                                <!-- Filled by JS -->
                            </div>
                        </div>
                    </section>

                    <!-- Balances Table Section -->
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">
                                Balances
                                <div class="info-trigger">
                                    ?
                                    <div class="info-panel">
                                        <div class="info-panel-title">Understanding Your Balance</div>
                                        <div class="info-panel-text">
                                            <strong>Available:</strong> Funds you can spend right now.<br><br>
                                            <strong>Locked:</strong> Funds in pending transactions or maturing. They'll become available automatically.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="balances-card">
                            <div class="balances-header">
                                <input type="text" class="search-input" id="balance-search" placeholder="Search assets..." oninput="filterBalances()">
                            </div>
                            <div class="balances-table-wrapper">
                                <table class="balances-table">
                                    <thead>
                                        <tr>
                                            <th onclick="sortBalances('name')">Asset <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></th>
                                            <th onclick="sortBalances('balance')">Balance <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></th>
                                            <th onclick="sortBalances('locked')">Locked</th>
                                            <th>Asset ID</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="balances-tbody">
                                        <!-- Filled by JS -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- UTXO Section -->
                        <button class="utxo-toggle" id="utxo-toggle" onclick="toggleUtxo()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M6 9l6 6 6-6"/>
                            </svg>
                            Show UTXOs (Advanced)
                            <div class="info-trigger" style="margin-left: auto;">
                                ?
                                <div class="info-panel" style="right: 0; left: auto; transform: none;">
                                    <div class="info-panel-title">What is a UTXO?</div>
                                    <div class="info-panel-text">
                                        UTXO stands for "Unspent Transaction Output". Think of UTXOs like individual bills in your physical wallet - each one has a specific value. When you spend, UTXOs are combined and split as needed, just like using cash.
                                    </div>
                                </div>
                            </div>
                        </button>

                        <div class="utxo-panel" id="utxo-panel">
                            <div id="utxo-recommendations" style="display:none;"></div>
                            <table class="utxo-table">
                                <thead>
                                    <tr>
                                        <th>Coin</th>
                                        <th>Maturity</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="utxo-tbody">
                                    <!-- Filled by JS -->
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- Assets Page -->
                <div class="page" id="page-assets">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">All Blockchain Assets</div>
                        </div>
                        <div class="balances-card">
                            <div class="balances-header" style="display:flex;gap:16px;align-items:center;flex-wrap:wrap;">
                                <input type="text" class="search-input" id="all-assets-search" placeholder="Search all assets on BEAM..." style="flex:1;min-width:200px;">
                                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;font-size:13px;color:var(--text-secondary);">
                                    <input type="checkbox" id="show-my-assets" onchange="toggleMyAssets()">
                                    My Created Assets
                                </label>
                                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;font-size:13px;color:var(--text-secondary);">
                                    <input type="checkbox" id="show-low-liquid" onchange="toggleShowLowLiquid()">
                                    Show low liquid
                                </label>
                                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;font-size:13px;color:var(--text-secondary);">
                                    <input type="checkbox" id="show-hidden-assets" onchange="toggleShowHidden()">
                                    Show hidden assets
                                </label>
                                <button class="quick-btn quick-btn-primary" onclick="openCreateTokenModal()" style="font-size:13px;padding:8px 16px;">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" style="vertical-align:middle;margin-right:6px;"><path d="M12 5v14M5 12h14"/></svg>
                                    Create Token
                                </button>
                            </div>
                            <table class="balances-table">
                                <thead>
                                    <tr>
                                        <th>Asset</th>
                                        <th>Your Balance</th>
                                        <th>Asset ID</th>
                                        <th>Total Supply</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="all-assets-tbody">
                                    <!-- Filled by JS -->
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- Transactions Page -->
                <div class="page" id="page-transactions">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">Transaction History</div>
                        </div>
                        <div id="transactions-list">
                            <div class="empty-state">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2v20M17 7l-5-5-5 5M7 17l5 5 5-5"/>
                                </svg>
                                <h3>No transactions yet</h3>
                                <p>Your transaction history will appear here</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Addresses Page -->
                <div class="page" id="page-addresses">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">Your Addresses</div>
                            <button class="quick-btn quick-btn-primary" onclick="generateNewAddress()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <path d="M12 5v14M5 12h14"/>
                                </svg>
                                New Address
                            </button>
                        </div>
                        <div id="addresses-list" class="balances-card">
                            <!-- Filled by JS -->
                        </div>
                    </section>
                </div>

                <!-- DEX Page -->
                <div class="page" id="page-dex">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">DEX Trading</div>
                            <div style="display:flex;gap:8px;">
                                <button class="quick-btn dex-tab active" data-dex-tab="swap" onclick="showDexTab('swap')">Swap</button>
                                <button class="quick-btn dex-tab" data-dex-tab="pools" onclick="showDexTab('pools')">Pools</button>
                                <button class="quick-btn dex-tab" data-dex-tab="liquidity" onclick="showDexTab('liquidity')">Liquidity</button>
                            </div>
                        </div>

                        <!-- Swap Tab -->
                        <div class="dex-panel active" id="dex-swap">
                            <div class="balances-card" style="max-width:480px;margin:0 auto;padding:24px;">
                                <h3 style="margin-bottom:20px;text-align:center;">Swap Tokens</h3>

                                <!-- From Token -->
                                <div class="swap-input-group" style="margin-bottom:8px;">
                                    <label style="font-size:12px;color:var(--text-muted);margin-bottom:4px;display:block;">You Pay</label>
                                    <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                        <input type="text" inputmode="decimal" id="dex-from-amount" class="swap-amount-input" placeholder="0.0" oninput="sanitizeNumericInput(this); debounceGetQuote()">
                                        <button class="token-select-btn" id="dex-from-token" onclick="openTokenSelector('from')">
                                            <div class="token-icon-small" id="dex-from-icon" style="background:var(--beam-cyan);">BE</div>
                                            <span id="dex-from-symbol">BEAM</span>
                                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                                        </button>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;">
                                        <div style="font-size:11px;color:var(--text-muted);">Balance: <span id="dex-from-balance">0</span></div>
                                        <div class="quick-amount-btns" style="display:flex;gap:4px;">
                                            <button class="quick-amount-btn" onclick="setQuickAmount(0.1)">0.1</button>
                                            <button class="quick-amount-btn" onclick="setQuickAmount(0.5)">0.5</button>
                                            <button class="quick-amount-btn" onclick="setQuickAmount(1)">1</button>
                                            <button class="quick-amount-btn" onclick="setQuickAmount('max')">MAX</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Swap Direction Button -->
                                <div style="text-align:center;margin:12px 0;">
                                    <button class="swap-direction-btn" onclick="swapDirection()" style="background:var(--void-lighter);border:2px solid var(--glass-border);border-radius:50%;width:40px;height:40px;cursor:pointer;">
                                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="var(--beam-cyan)" stroke-width="2"><path d="M7 16V4M7 4L3 8M7 4l4 4M17 8v12M17 20l4-4M17 20l-4-4"/></svg>
                                    </button>
                                </div>

                                <!-- To Token -->
                                <div class="swap-input-group" style="margin-bottom:16px;">
                                    <label style="font-size:12px;color:var(--text-muted);margin-bottom:4px;display:block;">You Receive</label>
                                    <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                        <input type="number" id="dex-to-amount" class="swap-amount-input" placeholder="0.0" readonly>
                                        <button class="token-select-btn" id="dex-to-token" onclick="openTokenSelector('to')">
                                            <div class="token-icon-small" id="dex-to-icon" style="background:var(--beam-pink);">?</div>
                                            <span id="dex-to-symbol">Select</span>
                                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                                        </button>
                                    </div>
                                </div>

                                <!-- Swap Info - matches AllDapps -->
                                <div id="dex-swap-info" style="display:none;background:var(--void);border-radius:10px;padding:16px;margin-bottom:16px;font-size:13px;border:1px solid var(--glass-border);">
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">Exchange Rate</span>
                                        <span id="dex-rate" style="font-family:'JetBrains Mono',monospace;">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">You Pay</span>
                                        <span id="dex-pay" style="font-family:'JetBrains Mono',monospace;color:var(--error);">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">You Receive</span>
                                        <span id="dex-receive" style="font-family:'JetBrains Mono',monospace;color:var(--success);">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">Pool Fee (0.3%)</span>
                                        <span id="dex-fee" style="font-family:'JetBrains Mono',monospace;">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;">
                                        <span style="color:var(--text-muted);">Min. Received</span>
                                        <span id="dex-min-receive" style="font-family:'JetBrains Mono',monospace;">-</span>
                                    </div>
                                </div>

                                <!-- Swap Button -->
                                <button class="quick-btn quick-btn-primary" id="dex-swap-btn" onclick="executeSwap()" style="width:100%;padding:16px;font-size:16px;" disabled>
                                    Select tokens
                                </button>

                                <!-- Recent Activity Feed -->
                                <div style="margin-top:24px;">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                                        <span style="font-size:13px;color:var(--text-muted);font-weight:500;">Recent Activity</span>
                                        <span id="activity-status" style="font-size:11px;color:var(--text-muted);">Loading...</span>
                                    </div>
                                    <div id="dex-activity-feed" style="max-height:320px;overflow-y:auto;">
                                        <div style="text-align:center;padding:24px;color:var(--text-muted);font-size:13px;">Loading recent activity...</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pools Tab -->
                        <div class="dex-panel" id="dex-pools">
                            <!-- Pool Filters -->
                            <div class="pools-filters" style="display:flex;flex-wrap:wrap;align-items:center;gap:16px;margin-bottom:16px;padding:12px;background:var(--void);border-radius:12px;">
                                <div style="display:flex;align-items:center;gap:8px;">
                                    <label style="font-size:12px;color:var(--text-muted);white-space:nowrap;">Min BEAM Reserve:</label>
                                    <input type="number" id="pool-min-beam" value="10000" placeholder="10000"
                                           style="width:100px;padding:6px 10px;background:var(--void-lighter);border:1px solid var(--border);border-radius:6px;color:var(--text);font-size:13px;"
                                           oninput="renderDexPools()">
                                </div>
                                <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:12px;color:var(--text-muted);">
                                    <input type="checkbox" id="pool-show-low-lp" onchange="renderDexPools()" style="width:16px;height:16px;cursor:pointer;">
                                    Show low liquidity pools
                                </label>
                                <div style="flex:1;"></div>
                                <button class="quick-btn" onclick="openCreatePoolUI()" style="font-size:12px;padding:6px 12px;">
                                    <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align:middle;margin-right:4px;"><path d="M12 5v14M5 12h14"/></svg>
                                    Create Pool
                                </button>
                                <span id="pools-count" style="font-size:12px;color:var(--text-muted);">0 pools</span>
                            </div>
                            <div id="pools-list" class="pools-grid">
                                <div style="text-align:center;padding:32px;color:var(--text-muted);">Loading pools...</div>
                            </div>
                        </div>

                        <!-- Liquidity Tab -->
                        <div class="dex-panel" id="dex-liquidity">
                            <!-- Liquidity Mode Tabs -->
                            <div style="display:flex;gap:8px;margin-bottom:20px;justify-content:center;">
                                <button class="quick-btn liq-mode-btn active" data-liq-mode="add" onclick="switchLiqMode('add')">Add Liquidity</button>
                                <button class="quick-btn liq-mode-btn" data-liq-mode="withdraw" onclick="switchLiqMode('withdraw')">Withdraw</button>
                            </div>

                            <!-- Add Liquidity Panel -->
                            <div class="liq-panel active" id="liq-add-panel">
                                <div class="balances-card" style="max-width:480px;margin:0 auto;padding:24px;">
                                    <h3 style="margin-bottom:8px;text-align:center;">Add Liquidity</h3>
                                    <p style="text-align:center;color:var(--text-muted);font-size:12px;margin-bottom:20px;">Provide liquidity to earn trading fees</p>

                                    <!-- Token A Selection with Amount -->
                                    <div class="swap-input-group" style="margin-bottom:12px;">
                                        <label style="font-size:12px;color:var(--text-muted);">Token A</label>
                                        <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                            <input type="text" inputmode="decimal" id="liq-amount-a" class="swap-amount-input" placeholder="0.0" oninput="sanitizeNumericInput(this); calcLiquidityB()">
                                            <div class="token-select-btn" id="liq-token-a" onclick="openTokenSelector('liq-a')" style="cursor:pointer;">
                                                <div class="token-icon-small" id="liq-icon-a" style="background:var(--beam-cyan);">BE</div>
                                                <span id="liq-symbol-a">BEAM</span>
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                                    <path d="M6 9l6 6 6-6"/>
                                                </svg>
                                            </div>
                                        </div>
                                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Balance: <span id="liq-balance-a">0</span></div>
                                    </div>

                                    <div style="text-align:center;margin:8px 0;color:var(--text-muted);">+</div>

                                    <!-- Token B Selection with Amount -->
                                    <div class="swap-input-group" style="margin-bottom:16px;">
                                        <label style="font-size:12px;color:var(--text-muted);">Token B</label>
                                        <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                            <input type="text" inputmode="decimal" id="liq-amount-b" class="swap-amount-input" placeholder="0.0" oninput="sanitizeNumericInput(this); calcLiquidityA()">
                                            <div class="token-select-btn" id="liq-token-b" onclick="openTokenSelector('liq-b')" style="cursor:pointer;">
                                                <div class="token-icon-small" id="liq-icon-b" style="background:var(--beam-pink);">FO</div>
                                                <span id="liq-symbol-b">FOMO</span>
                                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                                    <path d="M6 9l6 6 6-6"/>
                                                </svg>
                                            </div>
                                        </div>
                                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Balance: <span id="liq-balance-b">0</span></div>
                                    </div>

                                    <!-- Available Pools for Selected Pair -->
                                    <div id="liq-pool-options" style="margin-bottom:16px;">
                                        <label style="font-size:12px;color:var(--text-muted);display:block;margin-bottom:8px;">Select Pool (by fee)</label>
                                        <div id="liq-pool-list" style="display:flex;flex-wrap:wrap;gap:8px;">
                                            <!-- Pool options rendered here -->
                                            <div style="color:var(--text-muted);font-size:12px;">Select both tokens to see available pools</div>
                                        </div>
                                    </div>

                                    <!-- Pool Info -->
                                    <div id="liq-pool-info" style="display:none;background:var(--void);border-radius:8px;padding:12px;margin-bottom:16px;font-size:13px;">
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="color:var(--text-muted);">Pool Rate</span>
                                            <span id="liq-rate">-</span>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="color:var(--text-muted);">Your Share</span>
                                            <span id="liq-share">-</span>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;">
                                            <span style="color:var(--text-muted);">LP Tokens</span>
                                            <span id="liq-lp-tokens">-</span>
                                        </div>
                                    </div>

                                    <button class="quick-btn quick-btn-primary" id="add-liq-btn" onclick="showAddLiquidityConfirmation()" style="width:100%;padding:16px;" disabled>
                                        Select Pool
                                    </button>
                                </div>
                            </div>

                            <!-- Withdraw Liquidity Panel -->
                            <div class="liq-panel" id="liq-withdraw-panel">
                                <div class="balances-card" style="max-width:480px;margin:0 auto;padding:24px;">
                                    <h3 style="margin-bottom:8px;text-align:center;">Withdraw Liquidity</h3>
                                    <p style="text-align:center;color:var(--text-muted);font-size:12px;margin-bottom:20px;">Remove your liquidity from a pool</p>

                                    <!-- Your LP Positions -->
                                    <div id="lp-positions" style="margin-bottom:20px;">
                                        <div style="text-align:center;padding:24px;color:var(--text-muted);">Loading your LP positions...</div>
                                    </div>

                                    <!-- Withdraw Amount -->
                                    <div id="withdraw-form" style="display:none;">
                                        <div class="swap-input-group" style="margin-bottom:16px;">
                                            <label style="font-size:12px;color:var(--text-muted);">Withdraw Percentage</label>
                                            <div style="display:flex;gap:8px;margin-top:8px;">
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(25)">25%</button>
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(50)">50%</button>
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(75)">75%</button>
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(100)">100%</button>
                                            </div>
                                            <input type="range" id="withdraw-slider" min="0" max="100" value="100" style="width:100%;margin-top:12px;" oninput="updateWithdrawAmount()">
                                            <div style="text-align:center;font-size:24px;font-weight:600;margin-top:8px;"><span id="withdraw-percent">100</span>%</div>
                                        </div>

                                        <div id="withdraw-preview" style="background:var(--void);border-radius:8px;padding:12px;margin-bottom:16px;font-size:13px;">
                                            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                                <span style="color:var(--text-muted);">You'll Receive</span>
                                            </div>
                                            <div id="withdraw-amounts" style="font-weight:500;">-</div>
                                        </div>

                                        <button class="quick-btn quick-btn-danger" id="withdraw-liq-btn" onclick="showWithdrawConfirmation()" style="width:100%;padding:16px;">
                                            Withdraw Liquidity
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </section>
                </div>

                <!-- P2P Marketplace Page -->
                <div class="page" id="page-p2p">
                    <iframe id="p2p-iframe" src="/p2p/p2p.html" style="width: 100%; height: calc(100vh - 80px); border: none; background: transparent;"></iframe>
                </div>

                <!-- Airdrop Page -->
                <div class="page" id="page-airdrop">
                    <div class="airdrop-container">
                        <!-- Airdrop Tabs -->
                        <div class="airdrop-tabs">
                            <button class="airdrop-tab active" data-airdrop-tab="claim" onclick="showAirdropTab('claim')">Claim Voucher</button>
                            <button class="airdrop-tab" data-airdrop-tab="manage" onclick="showAirdropTab('manage')">Create & Manage</button>
                        </div>

                        <!-- Contract Address -->
                        <div class="airdrop-contract-bar" id="airdrop-contract-bar">
                            <span class="contract-label">Contract:</span>
                            <span class="contract-address" id="airdrop-contract-address" title="Click to copy"></span>
                            <button class="btn-copy-contract" id="btn-copy-contract" onclick="copyAirdropContract()" title="Copy contract ID">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                                </svg>
                            </button>
                        </div>

                        <!-- Airdrop Stats Bar -->
                        <div class="airdrop-stats-bar" id="airdrop-stats-bar">
                            <div class="airdrop-stat-pill">
                                <span class="airdrop-stat-label">Batches</span>
                                <span class="airdrop-stat-value" id="airdrop-stat-batches">--</span>
                            </div>
                            <div class="airdrop-stat-pill">
                                <span class="airdrop-stat-label">Vouchers</span>
                                <span class="airdrop-stat-value" id="airdrop-stat-vouchers">--</span>
                            </div>
                            <div class="airdrop-stat-pill">
                                <span class="airdrop-stat-label">Claimed</span>
                                <span class="airdrop-stat-value" id="airdrop-stat-claimed">--</span>
                            </div>
                            <div class="airdrop-stat-pill">
                                <span class="airdrop-stat-label">Available</span>
                                <span class="airdrop-stat-value" id="airdrop-stat-available">--</span>
                            </div>
                        </div>

                        <!-- Claim Tab -->
                        <div class="airdrop-tab-content active" id="airdrop-claim">
                            <div class="airdrop-claim-section">
                                <div class="claim-hero">
                                    <svg class="claim-hero-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="44" height="44">
                                        <path d="M20 12v10H4V12"/><path d="M2 7h20v5H2z"/><path d="M12 22V7"/>
                                        <path d="M12 7H7.5a2.5 2.5 0 010-5C11 2 12 7 12 7z"/>
                                        <path d="M12 7h4.5a2.5 2.5 0 000-5C13 2 12 7 12 7z"/>
                                    </svg>
                                    <h3>Redeem Airdrop Voucher</h3>
                                    <p>Enter a voucher code to claim your tokens. Codes are 16-character alphanumeric strings in XXXX-XXXX-XXXX-XXXX format.</p>
                                </div>
                                <div class="claim-input-group">
                                    <label>Voucher Code</label>
                                    <input type="text" id="voucher-code-input" placeholder="XXXX-XXXX-XXXX-XXXX" autocomplete="off" spellcheck="false">
                                    <div class="claim-status" id="claim-status"></div>
                                </div>
                                <div class="voucher-result-card" id="voucher-result" style="display:none;">
                                    <div class="voucher-result-header">
                                        <div class="voucher-asset-info">
                                            <div class="voucher-asset-icon" id="voucher-asset-icon"></div>
                                            <div class="voucher-asset-details">
                                                <span class="voucher-asset-name" id="voucher-asset-name"></span>
                                                <span class="voucher-asset-id" id="voucher-asset-id"></span>
                                            </div>
                                        </div>
                                        <div class="voucher-status-badge" id="voucher-status-badge"></div>
                                    </div>
                                    <div class="voucher-value" id="voucher-value"></div>
                                    <button class="btn-claim" id="btn-claim-voucher" onclick="claimVoucher()" style="display:none;">Claim Tokens</button>
                                </div>
                            </div>

                            <!-- Airdrop Transaction History -->
                            <div class="airdrop-tx-section">
                                <h3>Airdrop Transactions</h3>
                                <div id="airdrop-tx-list" class="airdrop-tx-list">
                                    <div class="airdrop-tx-empty">No airdrop transactions yet</div>
                                </div>
                            </div>
                        </div>

                        <!-- Manage Tab -->
                        <div class="airdrop-tab-content" id="airdrop-manage">
                            <!-- Create Batch Form -->
                            <div class="airdrop-create-section">
                                <h3>Create Voucher Batch</h3>
                                <div class="create-form">
                                    <div class="form-row">
                                        <label>Asset</label>
                                        <div class="airdrop-asset-selector" id="airdrop-asset-selector">
                                            <div class="asset-selector-selected" id="asset-selector-selected" onclick="toggleAirdropAssetDropdown()">
                                                <span class="asset-selector-preview" id="asset-selector-preview"></span>
                                                <svg class="asset-selector-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16"><polyline points="6 9 12 15 18 9"/></svg>
                                            </div>
                                            <div class="asset-selector-dropdown" id="asset-selector-dropdown"></div>
                                            <input type="hidden" id="airdrop-asset-select" value="174">
                                        </div>
                                        <div class="asset-selector-help">
                                            <span class="asset-help-icon" title="To add more assets: edit config/assets.json with asset ID, name, symbol, icon URL, and decimals. Then restart the server.">?</span>
                                        </div>
                                    </div>
                                    <div class="airdrop-balance-row" id="airdrop-balance-row">
                                        <span class="balance-label">Your balance:</span>
                                        <span class="balance-value" id="airdrop-asset-balance">--</span>
                                    </div>
                                    <div class="form-row">
                                        <label>Value per Voucher</label>
                                        <input type="number" id="airdrop-value" placeholder="1.0" min="0.00000001" step="0.00000001">
                                    </div>
                                    <div class="form-row">
                                        <label>Number of Vouchers</label>
                                        <input type="number" id="airdrop-count" placeholder="10" min="1" max="100" value="10">
                                    </div>
                                    <div class="create-summary" id="create-summary">
                                        <div class="cost-breakdown">
                                            <span>Vouchers: <strong id="total-cost">0</strong> <span id="total-cost-symbol">FOMO</span></span>
                                            <span class="cost-fee">+ 1% fee: <strong id="total-fee">0</strong> <span id="total-fee-symbol">FOMO</span></span>
                                        </div>
                                        <div class="cost-total-line">
                                            Total: <strong id="total-with-fee">0</strong> <span id="total-with-fee-symbol">FOMO</span>
                                        </div>
                                    </div>
                                    <button class="btn-create-batch" id="btn-create-batch" onclick="createAirdropBatch()">Create Batch</button>
                                    <div class="create-progress" id="create-progress" style="display:none;">
                                        <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
                                        <span class="progress-text" id="progress-text">Creating...</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Generated Codes Display (shown after creating) -->
                            <div class="airdrop-codes-section" id="airdrop-codes-section" style="display:none;">
                                <h3>Generated Voucher Codes</h3>
                                <div class="codes-warning">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2" width="18" height="18" style="vertical-align:middle;margin-right:6px;">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
                                        <line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                    Save these codes now! They are only stored in your browser's localStorage. Export or copy them before clearing browser data.
                                </div>
                                <div class="codes-actions">
                                    <button class="btn-action-codes" onclick="copyAllCodes()">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                                        </svg>
                                        Copy All Codes
                                    </button>
                                    <button class="btn-action-codes btn-export" onclick="exportCodesCSV()">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                                            <polyline points="7 10 12 15 17 10"/>
                                            <line x1="12" y1="15" x2="12" y2="3"/>
                                        </svg>
                                        Download CSV
                                    </button>
                                </div>
                                <div class="codes-table-wrapper">
                                    <table class="codes-table" id="codes-table">
                                        <thead><tr><th>#</th><th>Code</th><th>Value</th><th>Status</th></tr></thead>
                                        <tbody id="codes-table-body"></tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Saved Voucher Codes (persistent, loaded from localStorage) -->
                            <div class="airdrop-saved-codes-section" id="airdrop-saved-codes-section">
                                <div class="saved-codes-header">
                                    <h3>My Voucher Codes</h3>
                                    <button class="btn-small" onclick="refreshSavedCodesStatus()" id="btn-refresh-codes" title="Check on-chain status">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
                                        Refresh
                                    </button>
                                </div>
                                <div id="saved-codes-list" class="saved-codes-list">
                                    <div class="airdrop-tx-empty">No saved codes. Create a batch to generate voucher codes.</div>
                                </div>
                            </div>

                            <!-- My Batches (on-chain) -->
                            <div class="airdrop-batches-section">
                                <h3>My Batches (On-Chain)</h3>
                                <div id="my-batches-list" class="batches-list">
                                    <div class="empty-state">No batches yet</div>
                                </div>
                            </div>

                            <!-- Admin Panel (visible only for contract owner) -->
                            <div class="airdrop-admin-section" id="airdrop-admin-section" style="display:none;">
                                <div class="admin-header">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="2" width="20" height="20">
                                        <path d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                                    </svg>
                                    <h3>Admin Panel</h3>
                                    <span class="admin-badge">Owner</span>
                                </div>
                                <div class="admin-fees-section">
                                    <div class="admin-fees-header">
                                        <h4>Collected Fees</h4>
                                        <button class="btn-small" onclick="loadAirdropFees()" id="btn-refresh-fees" title="Refresh fee balances">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14"><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
                                            Refresh
                                        </button>
                                    </div>
                                    <div id="admin-fees-list" class="admin-fees-list">
                                        <div class="airdrop-tx-empty">Loading fees...</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Explorer Page -->
                <div class="page" id="page-explorer">
                    <!-- Explorer Header Banner -->
                    <div class="explorer-banner">
                        <h2>Explore the BEAM Blockchain</h2>
                        <p>BEAM is a privacy-focused cryptocurrency using Mimblewimble technology. All transactions are private by default.</p>
                    </div>

                    <!-- Explorer Sub-Navigation -->
                    <div class="explorer-tabs">
                        <button class="explorer-tab active" data-explorer-tab="overview" onclick="showExplorerTab('overview')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                            Home
                        </button>
                        <button class="explorer-tab" data-explorer-tab="blocks" onclick="showExplorerTab('blocks')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <rect x="3" y="3" width="7" height="7"/>
                                <rect x="14" y="3" width="7" height="7"/>
                                <rect x="14" y="14" width="7" height="7"/>
                                <rect x="3" y="14" width="7" height="7"/>
                            </svg>
                            Blocks
                        </button>
                        <button class="explorer-tab" data-explorer-tab="assets" onclick="showExplorerTab('assets')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 6v12M6 12h12"/>
                            </svg>
                            Assets
                        </button>
                        <button class="explorer-tab" data-explorer-tab="dex" onclick="showExplorerTab('dex')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M16 3h5v5M4 20L21 3M21 16v5h-5"/>
                            </svg>
                            DEX
                        </button>
                        <button class="explorer-tab" data-explorer-tab="contracts" onclick="showExplorerTab('contracts')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"/>
                            </svg>
                            Contracts
                        </button>
                        <button class="explorer-tab" data-explorer-tab="swaps" onclick="showExplorerTab('swaps')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M8 12h8M12 8v8"/>
                            </svg>
                            Atomic Swaps
                        </button>
                        <div class="explorer-api-badge" id="explorer-api-badge">
                            <span class="connection-dot"></span>
                            <span id="explorer-api-name">Not connected</span>
                        </div>
                    </div>

                    <!-- Explorer Content Area -->
                    <div class="explorer-content-area">
                        <!-- Overview Tab -->
                        <div class="explorer-tab-content active" id="explorer-tab-overview">
                            <!-- Stats Pills Row -->
                            <div class="explorer-stats-row">
                                <div class="explorer-stat-pill">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Block Height</span>
                                        <span class="stat-pill-value" id="explorer-height">--</span>
                                    </div>
                                </div>
                                <div class="explorer-stat-pill">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Peers Connected</span>
                                        <span class="stat-pill-value" id="explorer-peers">--</span>
                                    </div>
                                </div>
                                <div class="explorer-stat-pill">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Chainwork</span>
                                        <span class="stat-pill-value" id="explorer-chainwork">--</span>
                                    </div>
                                </div>
                                <div class="explorer-stat-pill">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Shielded Outs (24h)</span>
                                        <span class="stat-pill-value" id="explorer-shielded-24h">--</span>
                                    </div>
                                </div>
                                <div class="explorer-stat-pill">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Total Shielded Outs</span>
                                        <span class="stat-pill-value" id="explorer-shielded-total">--</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Stats Pills Row 2 -->
                            <div class="explorer-stats-row" style="margin-top: 12px;">
                                <div class="explorer-stat-pill">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Shielded Ready (hrs)</span>
                                        <span class="stat-pill-value" id="explorer-shielded-ready">--</span>
                                    </div>
                                </div>
                                <div class="explorer-stat-pill">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Last Block</span>
                                        <span class="stat-pill-value" id="explorer-last-block">--</span>
                                    </div>
                                </div>
                                <div class="explorer-stat-pill wide">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22 6 12 13 2 6"/>
                                    </svg>
                                    <div class="stat-pill-content">
                                        <span class="stat-pill-label">Block Hash</span>
                                        <span class="stat-pill-value mono-text" id="explorer-block-hash" style="font-size: 11px;">--</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Main Search Box -->
                            <div class="explorer-search-box" style="margin-top: 24px;">
                                <div class="search-input-wrapper">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                        <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
                                    </svg>
                                    <input type="text" id="explorer-main-search" placeholder="Search by block height, block hash, or kernel ID..." onkeydown="if(event.key==='Enter') searchExplorerMain()">
                                    <button class="search-btn" onclick="searchExplorerMain()">Search</button>
                                </div>
                            </div>

                            <!-- Recent Blocks Section -->
                            <section class="section" style="margin-top: 32px;">
                                <div class="section-header">
                                    <div class="section-title">Recent Blocks</div>
                                    <button class="quick-btn" onclick="showExplorerTab('blocks')">View All Blocks </button>
                                </div>
                                <!-- Blocks Table -->
                                <div class="explorer-table-wrapper">
                                    <table class="explorer-table" id="explorer-recent-blocks-table">
                                        <thead>
                                            <tr>
                                                <th>HEIGHT</th>
                                                <th>TIME</th>
                                                <th>TXS</th>
                                                <th>MW IN</th>
                                                <th>MW OUT</th>
                                                <th>FEE (BEAM)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="explorer-recent-blocks">
                                            <tr><td colspan="6" class="loading-state">Loading blocks...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </section>
                        </div>

                        <!-- Blocks Tab -->
                        <div class="explorer-tab-content" id="explorer-tab-blocks">
                            <section class="section">
                                <div class="section-header">
                                    <div class="section-title">All Blocks</div>
                                    <button class="quick-btn" onclick="loadExplorerBlocks()" id="blocks-refresh-btn">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                            <path d="M23 4v6h-6M1 20v-6h6"/>
                                            <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                        </svg>
                                        Refresh
                                    </button>
                                </div>

                                <!-- Column Filters -->
                                <div class="column-filters" id="block-column-filters">
                                    <span class="filter-label">Columns:</span>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="Height" checked disabled> Height</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="Timestamp" checked onchange="updateBlockColumns()"> Time</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="Txs" checked onchange="updateBlockColumns()"> Txs</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="MW.Inputs" checked onchange="updateBlockColumns()"> MW In</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="MW.Outputs" checked onchange="updateBlockColumns()"> MW Out</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="Fee" checked onchange="updateBlockColumns()"> Fee</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="SH.Inputs" onchange="updateBlockColumns()"> SH In</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="SH.Outputs" onchange="updateBlockColumns()"> SH Out</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="Difficulty" onchange="updateBlockColumns()"> Difficulty</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="Chainwork" onchange="updateBlockColumns()"> Chainwork</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="Contracts" onchange="updateBlockColumns()"> Contracts</label>
                                    <label class="filter-checkbox"><input type="checkbox" data-col="ContractCalls" onchange="updateBlockColumns()"> Calls</label>
                                </div>

                                <div class="explorer-table-wrapper">
                                    <table class="explorer-table" id="explorer-blocks-table">
                                        <thead id="blocks-table-header">
                                            <tr>
                                                <th>HEIGHT</th>
                                                <th>TIME</th>
                                                <th>TXS</th>
                                                <th>MW IN</th>
                                                <th>MW OUT</th>
                                                <th>FEE (BEAM)</th>
                                            </tr>
                                        </thead>
                                        <tbody id="explorer-blocks-list">
                                            <tr><td colspan="6" class="loading-state">Loading blocks...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="explorer-pagination" id="blocks-pagination" style="display: none;">
                                    <button class="quick-btn" onclick="loadMoreBlocks()">Load More Blocks</button>
                                </div>
                            </section>
                        </div>

                        <!-- Assets Tab -->
                        <div class="explorer-tab-content" id="explorer-tab-assets">
                            <section class="section">
                                <div class="section-header">
                                    <div class="section-title">Confidential Assets</div>
                                    <div style="display: flex; gap: 12px; align-items: center;">
                                        <input type="text" id="explorer-asset-search" class="search-input" placeholder="Search by name or ID..." style="width: 200px;" oninput="filterExplorerAssets()">
                                        <button class="quick-btn" onclick="loadExplorerAssets(true)">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                                <path d="M23 4v6h-6M1 20v-6h6"/>
                                                <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                            </svg>
                                            Refresh
                                        </button>
                                    </div>
                                </div>
                                <div class="explorer-assets-grid" id="explorer-assets-grid">
                                    <div class="loading-state">Loading assets...</div>
                                </div>
                            </section>
                        </div>

                        <!-- DEX Tab -->
                        <div class="explorer-tab-content" id="explorer-tab-dex">
                            <section class="section">
                                <div class="section-header">
                                    <div class="section-title">Liquidity Pools</div>
                                    <button class="quick-btn" onclick="loadExplorerDexPools(true)">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                            <path d="M23 4v6h-6M1 20v-6h6"/>
                                            <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                        </svg>
                                        Refresh
                                    </button>
                                </div>
                                <div class="explorer-table-wrapper">
                                    <table class="explorer-table dex-pools-table">
                                        <thead>
                                            <tr>
                                                <th>Pool Pair</th>
                                                <th>Reserve 1</th>
                                                <th>Reserve 2</th>
                                                <th>Exchange Rate</th>
                                                <th>Volatility</th>
                                                <th>LP Token</th>
                                            </tr>
                                        </thead>
                                        <tbody id="explorer-dex-pools">
                                            <tr><td colspan="6" class="loading-state">Loading pools...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </section>

                            <section class="section" style="margin-top: 24px;">
                                <div class="section-header">
                                    <div class="section-title">Recent Trades</div>
                                </div>
                                <div class="explorer-table-wrapper">
                                    <table class="explorer-table">
                                        <thead>
                                            <tr>
                                                <th>Block</th>
                                                <th>Type</th>
                                                <th>From</th>
                                                <th>To</th>
                                            </tr>
                                        </thead>
                                        <tbody id="explorer-dex-trades">
                                            <tr><td colspan="4" class="loading-state">Loading trades...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </section>
                        </div>

                        <!-- Atomic Swaps Tab -->
                        <div class="explorer-tab-content" id="explorer-tab-swaps">
                            <section class="section">
                                <div class="section-header">
                                    <div class="section-title">Atomic Swap Totals</div>
                                    <button class="quick-btn" onclick="loadExplorerAtomicSwaps()">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                            <path d="M23 4v6h-6M1 20v-6h6"/>
                                            <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                        </svg>
                                        Refresh
                                    </button>
                                </div>
                                <div class="swap-totals-grid" id="swap-totals-grid">
                                    <div class="loading-state">Loading swap data...</div>
                                </div>
                            </section>

                            <section class="section" style="margin-top: 24px;">
                                <div class="section-header">
                                    <div class="section-title">Active Swap Offers</div>
                                </div>
                                <div class="explorer-table-wrapper">
                                    <table class="explorer-table">
                                        <thead>
                                            <tr>
                                                <th>Offer</th>
                                                <th>Offering</th>
                                                <th>Receiving</th>
                                                <th>Rate</th>
                                                <th>Status</th>
                                            </tr>
                                        </thead>
                                        <tbody id="explorer-swap-offers">
                                            <tr><td colspan="5" class="loading-state">Loading offers...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </section>
                        </div>

                        <!-- Contracts Tab -->
                        <div class="explorer-tab-content" id="explorer-tab-contracts">
                            <section class="section">
                                <div class="section-header">
                                    <div class="section-title">Smart Contracts</div>
                                    <button class="quick-btn" onclick="loadExplorerContracts(true)">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                            <path d="M23 4v6h-6M1 20v-6h6"/>
                                            <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                        </svg>
                                        Refresh
                                    </button>
                                </div>
                                <div class="explorer-search-box">
                                    <input type="text" class="search-input" id="explorer-contract-search" placeholder="Search by contract ID or type (e.g. Nephrite, Minter, DEX)..." oninput="filterExplorerContracts()">
                                </div>
                                <div class="explorer-table-wrapper">
                                    <table class="explorer-table">
                                        <thead>
                                            <tr>
                                                <th>Contract ID</th>
                                                <th>Kind</th>
                                                <th>Deploy Height</th>
                                                <th>Locked Funds</th>
                                                <th>Owned Assets</th>
                                            </tr>
                                        </thead>
                                        <tbody id="explorer-contracts-list">
                                            <tr><td colspan="5" class="loading-state">Loading contracts...</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </section>
                        </div>
                    </div>

                    <!-- Not Connected Message -->
                    <div class="explorer-not-connected" id="explorer-not-connected" style="display: none;">
                        <div class="not-connected-content">
                            <svg viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="1.5" width="64" height="64">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M12 8v4M12 16h.01"/>
                            </svg>
                            <h3>Explorer Not Connected</h3>
                            <p>Configure your Explorer API in Settings to view blockchain data.</p>
                            <button class="quick-btn quick-btn-primary" onclick="App.showPage('settings')">
                                Go to Settings
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Explorer Asset Detail Page -->
                <div class="page" id="page-explorer-asset-detail">
                    <section class="section">
                        <a href="#" class="back-link" onclick="showExplorerTab('assets'); App.showPage('explorer'); return false;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M19 12H5M12 19l-7-7 7-7"/>
                            </svg>
                            Back to Assets
                        </a>
                        <div id="asset-detail-content">
                            <div class="loading-state">Loading asset...</div>
                        </div>
                    </section>
                </div>

                <!-- Explorer Contract Detail Page -->
                <div class="page" id="page-explorer-contract-detail">
                    <section class="section">
                        <a href="#" class="back-link" onclick="showExplorerTab('contracts'); App.showPage('explorer'); return false;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M19 12H5M12 19l-7-7 7-7"/>
                            </svg>
                            Back to Contracts
                        </a>
                        <div id="contract-detail-content">
                            <div class="loading-state">Loading contract...</div>
                        </div>
                    </section>
                </div>

                <!-- Explorer Block Detail Page -->
                <div class="page" id="page-explorer-block-detail">
                    <section class="section">
                        <a href="#" class="back-link" onclick="showExplorerTab('blocks'); App.showPage('explorer'); return false;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M19 12H5M12 19l-7-7 7-7"/>
                            </svg>
                            Back to Blocks
                        </a>
                        <div id="block-detail-content">
                            <div class="loading-state">Loading block...</div>
                        </div>
                    </section>
                </div>

                <!-- App Store Page -->
                <div class="page" id="page-appstore">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">App Store</div>
                        </div>
                        <div id="appstore-grid" class="appstore-grid"></div>
                    </section>
                </div>

                <!-- Fuddle Game Page -->
                <div class="page" id="page-fuddle">
                    <div id="fuddle-root"></div>
                </div>

                <!-- Donate Page -->
                <div class="page" id="page-donate">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">Support Development</div>
                        </div>

                        <div class="balances-card" style="padding: 32px; text-align: center;">
                            <div style="margin-bottom: 24px;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="var(--beam-cyan)" stroke-width="1.5" width="64" height="64" style="margin-bottom: 16px;">
                                    <path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/>
                                </svg>
                                <h2 style="color: var(--text-primary); margin-bottom: 8px;">Thank You for Using BEAM Light Wallet</h2>
                                <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto 12px auto;">
                                    Developed by <a href="https://github.com/vsnation" target="_blank" style="color: var(--beam-cyan);">@vsnation</a>
                                </p>
                                <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">
                                    Your donations help fund continued development, bug fixes, and new features.
                                </p>
                            </div>

                            <div style="background: var(--void); border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                                <div style="color: var(--text-muted); font-size: 12px; margin-bottom: 8px; text-align: center;">DONATION ADDRESS</div>
                                <div id="donate-address" class="mono-text" style="font-size: 11px; word-break: break-all; color: var(--beam-cyan); margin-bottom: 16px; padding: 12px; background: var(--bg-primary); border-radius: 8px; text-align: center;">
                                    e17cc06481d9ae88e1e0181efee407fa8c36a861b9df723845eddc8fb1ba552048
                                </div>
                                <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                                    <button class="quick-btn quick-btn-primary" onclick="copyDonateAddress()">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" style="margin-right: 6px;">
                                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                                        </svg>
                                        Copy Address
                                    </button>
                                    <button class="quick-btn quick-btn-secondary" onclick="sendDonation()">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16" style="margin-right: 6px;">
                                            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
                                        </svg>
                                        Send Donation
                                    </button>
                                </div>
                            </div>

                            <div style="display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                                <button class="quick-btn quick-btn-secondary" onclick="sendDonationAmount(1)" style="min-width: 100px;">
                                    1 BEAM
                                </button>
                                <button class="quick-btn quick-btn-secondary" onclick="sendDonationAmount(5)" style="min-width: 100px;">
                                    5 BEAM
                                </button>
                                <button class="quick-btn quick-btn-secondary" onclick="sendDonationAmount(10)" style="min-width: 100px;">
                                    10 BEAM
                                </button>
                                <button class="quick-btn quick-btn-primary" onclick="sendDonationAmount(50)" style="min-width: 100px;">
                                    50 BEAM
                                </button>
                            </div>

                            <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid var(--void-lighter);">
                                <h3 style="color: var(--text-primary); margin-bottom: 16px;">What Your Donation Supports</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; text-align: left;">
                                    <div style="padding: 16px; background: var(--void); border-radius: 8px;">
                                        <div style="color: var(--beam-cyan); font-weight: 600; margin-bottom: 4px;">Development</div>
                                        <div style="color: var(--text-secondary); font-size: 13px;">New features, improvements, and bug fixes</div>
                                    </div>
                                    <div style="padding: 16px; background: var(--void); border-radius: 8px;">
                                        <div style="color: var(--beam-cyan); font-weight: 600; margin-bottom: 4px;">Infrastructure</div>
                                        <div style="color: var(--text-secondary); font-size: 13px;">Server costs and maintenance</div>
                                    </div>
                                    <div style="padding: 16px; background: var(--void); border-radius: 8px;">
                                        <div style="color: var(--beam-cyan); font-weight: 600; margin-bottom: 4px;">Security</div>
                                        <div style="color: var(--text-secondary); font-size: 13px;">Audits and security improvements</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Settings Page -->
                <div class="page" id="page-settings">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">Settings</div>
                        </div>

                        <!-- Connection Status -->
                        <div class="balances-card" style="padding: 24px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <h3>Connection Status</h3>
                                <span id="live-indicator" class="live-indicator">
                                    <span class="live-dot"></span>
                                    LIVE
                                </span>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Status</span>
                                    <span id="settings-status">Checking...</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Block Height</span>
                                    <span id="settings-height" class="mono-text">-</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Network</span>
                                    <span>Mainnet</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Last Updated</span>
                                    <span id="settings-last-update" class="mono-text">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Node Configuration -->
                        <div class="balances-card" style="padding: 24px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <h3>Node Configuration</h3>
                                <span class="info-trigger">?
                                    <div class="info-panel">
                                        <div class="info-panel-title">Node Types</div>
                                        <div class="info-panel-text">
                                            <strong>Public Node:</strong> Fast connection, no setup required. Use for everyday transactions.<br><br>
                                            <strong>Local Node (fast_sync):</strong> Better privacy, DEX shader support. Required for swaps. Takes time to sync initially.
                                        </div>
                                    </div>
                                </span>
                            </div>

                            <!-- Node Type Selector -->
                            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                                <button class="node-type-btn active" id="node-public-btn" onclick="selectNodeType('public', true)">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                        <circle cx="12" cy="12" r="10"/>
                                        <path d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/>
                                    </svg>
                                    <span>Public Node</span>
                                </button>
                                <button class="node-type-btn" id="node-local-btn" onclick="selectNodeType('local', true)">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                        <rect x="2" y="3" width="20" height="14" rx="2"/>
                                        <path d="M8 21h8M12 17v4"/>
                                    </svg>
                                    <span>Local Node</span>
                                </button>
                            </div>

                            <!-- Current Node Info -->
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Current Node</span>
                                    <span id="settings-node" class="mono-text" style="font-size: 12px;">eu-node01.mainnet.beam.mw:8100</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Node Type</span>
                                    <span id="settings-node-type">Public</span>
                                </div>
                            </div>

                            <!-- Local Node Sync Progress -->
                            <div id="local-node-section" style="margin-top: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                    <span style="color: var(--text-secondary); font-size: 14px; font-weight: 500;">Local Node</span>
                                    <div style="display: flex; gap: 8px;">
                                        <button class="quick-btn" onclick="startLocalNode()" style="padding: 4px 12px; font-size: 12px;">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                                <polygon points="5 3 19 12 5 21 5 3"/>
                                            </svg>
                                            Start
                                        </button>
                                        <button class="quick-btn" onclick="stopLocalNode()" style="padding: 4px 12px; font-size: 12px;">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                                <rect x="6" y="6" width="12" height="12"/>
                                            </svg>
                                            Stop
                                        </button>
                                    </div>
                                </div>
                                <div style="padding: 16px; background: var(--void); border-radius: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <span style="color: var(--text-muted); font-size: 13px;">Sync Progress</span>
                                        <span id="sync-percentage" style="color: var(--beam-cyan); font-weight: 600; font-size: 15px;">0%</span>
                                    </div>
                                    <div class="sync-progress-bar">
                                        <div class="sync-progress-fill" id="sync-progress-fill" style="width: 0%;"></div>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 12px;">
                                        <span id="sync-status-text" style="color: var(--text-muted);">Waiting...</span>
                                        <span id="sync-blocks" style="color: var(--text-muted);">0 / 0 headers</span>
                                    </div>
                                </div>
                                <p style="margin-top: 12px; font-size: 12px; color: var(--text-muted);">
                                    Running a local node enables DEX features and provides better privacy.
                                    Initial sync downloads ~3.7GB of blockchain headers.
                                </p>
                            </div>

                            <!-- Node Selection Dropdown -->
                            <div style="margin-top: 16px;">
                                <label style="display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 13px;">Select Node</label>
                                <select id="node-selector" class="search-input" style="width: 100%; cursor: pointer;" onchange="changeNode()">
                                    <option value="eu-node01.mainnet.beam.mw:8100">EU Node 1 (Primary)</option>
                                    <option value="eu-node02.mainnet.beam.mw:8100">EU Node 2</option>
                                    <option value="us-node01.mainnet.beam.mw:8100">US Node 1</option>
                                    <option value="us-node02.mainnet.beam.mw:8100">US Node 2</option>
                                    <option value="ap-node01.mainnet.beam.mw:8100">Asia Pacific Node</option>
                                    <option value="127.0.0.1:10005">Local Node (127.0.0.1:10005)</option>
                                </select>
                            </div>

                            <!-- Reconnect Button -->
                            <button class="quick-btn quick-btn-secondary" style="width: 100%; margin-top: 16px;" onclick="reconnectNode()" id="reconnect-btn">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                    <path d="M23 4v6h-6M1 20v-6h6"/>
                                    <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                </svg>
                                Reconnect to Node
                            </button>
                        </div>

                        <!-- DEX Support Info -->
                        <div class="balances-card" style="padding: 24px;">
                            <h3 style="margin-bottom: 16px;">DEX & Shaders</h3>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">DEX Support</span>
                                    <span id="dex-support-status" style="display: flex; align-items: center; gap: 6px;">
                                        <span class="status-dot status-checking"></span>
                                        Checking...
                                    </span>
                                </div>
                                <div style="padding: 12px; background: var(--warning-dim); border-radius: 8px; display: none;" id="dex-warning">
                                    <div style="display: flex; align-items: start; gap: 8px;">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="2" width="18" height="18" style="flex-shrink: 0; margin-top: 2px;">
                                            <circle cx="12" cy="12" r="10"/>
                                            <path d="M12 8v4M12 16h.01"/>
                                        </svg>
                                        <span style="color: var(--warning); font-size: 13px;">
                                            Public nodes don't support DEX shaders. Switch to a local node to use swap functionality.
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Explorer Node Configuration -->
                        <div class="balances-card" style="padding: 24px; margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <h3>Explorer API</h3>
                                <span id="explorer-connection-status" style="display: flex; align-items: center; gap: 6px; font-size: 12px;">
                                    <span class="status-dot status-checking"></span>
                                    Checking...
                                </span>
                            </div>
                            <p style="color: var(--text-secondary); font-size: 13px; margin: 0 0 16px 0;">
                                Configure the Explorer API for viewing blockchain data, recent blocks, and network statistics.
                            </p>
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 13px;">Explorer Node</label>
                                <select id="explorer-node-selector" class="search-input" style="width: 100%; cursor: pointer;" onchange="changeExplorerNode()">
                                    <option value="https://explorer.0xmx.net/api">explorer.0xmx.net (Primary)</option>
                                    <option value="https://explorer-api.beamprivacy.com">beamprivacy.com</option>
                                    <option value="https://BeamSmart.net:8000">BeamSmart.net</option>
                                </select>
                            </div>
                            <button class="quick-btn quick-btn-secondary" style="width: 100%;" onclick="testExplorerConnection()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
                                </svg>
                                Test Connection
                            </button>
                        </div>

                        <!-- Wallet Maintenance -->
                        <div class="balances-card" style="padding: 24px; margin-top: 20px;">
                            <h3 style="margin-bottom: 16px;">Wallet Maintenance</h3>
                            <p style="color: var(--text-secondary); font-size: 13px; margin: 0 0 16px 0;">
                                Rescan blockchain to recover missing balances after restoring a wallet.
                            </p>
                            <button class="rescan-btn" id="rescan-btn" onclick="triggerRescan()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                    <path d="M23 4v6h-6M1 20v-6h6"/>
                                    <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                </svg>
                                Rescan Wallet
                            </button>
                        </div>

                        <!-- App Updates -->
                        <div class="balances-card" style="padding: 24px; margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <h3>App Updates</h3>
                                <span id="app-version" style="font-size: 12px; color: var(--text-muted); background: var(--glass); padding: 4px 8px; border-radius: 4px;"></span>
                            </div>
                            <p style="color: var(--text-secondary); font-size: 13px; margin: 0 0 16px 0;">
                                Check for new versions and update the wallet application.
                            </p>
                            <div style="display: flex; gap: 12px;">
                                <button class="quick-btn" onclick="checkForUpdates(true)" style="flex: 1;">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                                        <polyline points="7 10 12 15 17 10"/>
                                        <line x1="12" y1="15" x2="12" y2="3"/>
                                    </svg>
                                    Check for Updates
                                </button>
                                <a href="https://github.com/vsnation/Beam-Light-Wallet/releases" target="_blank" class="quick-btn quick-btn-secondary" style="flex: 1; text-decoration: none; text-align: center;">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                        <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0020 4.77 5.07 5.07 0 0019.91 1S18.73.65 16 2.48a13.38 13.38 0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 005 4.77a5.44 5.44 0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 009 18.13V22"/>
                                    </svg>
                                    GitHub Releases
                                </a>
                            </div>
                        </div>

                        <!-- Telegram Notifications -->
                        <div class="balances-card" style="padding: 24px; margin-top: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <h3> Telegram Notifications</h3>
                                <span id="telegram-status" style="display: flex; align-items: center; gap: 6px; font-size: 12px;">
                                    <span class="status-dot" id="telegram-status-dot"></span>
                                    <span id="telegram-status-text">Not configured</span>
                                </span>
                            </div>
                            <p style="color: var(--text-secondary); font-size: 13px; margin: 0 0 16px 0;">
                                Receive real-time notifications for incoming transactions, P2P trades, and other wallet activities via Telegram.
                            </p>

                            <!-- Bot Token -->
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <label style="color: var(--text-muted); font-size: 13px;">Bot Token</label>
                                    <span class="info-trigger">?
                                        <div class="info-panel">
                                            <div class="info-panel-title">How to get a Bot Token</div>
                                            <div class="info-panel-text">
                                                1. Open Telegram and search for <strong>@BotFather</strong><br>
                                                2. Send <code>/newbot</code> command<br>
                                                3. Choose a name for your bot (e.g., "My BEAM Wallet")<br>
                                                4. Choose a username ending with "bot" (e.g., "my_beam_wallet_bot")<br>
                                                5. BotFather will send you the token (looks like: <code>123456789:ABC-DEF...</code>)<br>
                                                6. Copy and paste the token here
                                            </div>
                                        </div>
                                    </span>
                                </div>
                                <input type="password" id="telegram-bot-token" class="search-input" placeholder="123456789:ABC-DEF1234ghIkl-zyx57W2v1u123ew11"
                                    style="width: 100%; font-family: var(--font-mono); font-size: 12px;">
                            </div>

                            <!-- User ID -->
                            <div style="margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <label style="color: var(--text-muted); font-size: 13px;">Your Telegram User ID</label>
                                    <span class="info-trigger">?
                                        <div class="info-panel">
                                            <div class="info-panel-title">How to get your User ID</div>
                                            <div class="info-panel-text">
                                                1. Open Telegram and search for <strong>@userinfobot</strong> or <strong>@getmyid_bot</strong><br>
                                                2. Send any message to the bot<br>
                                                3. The bot will reply with your User ID (a number like: <code>123456789</code>)<br>
                                                4. Copy and paste your ID here<br><br>
                                                <em>Your User ID ensures only YOU receive notifications from your bot.</em>
                                            </div>
                                        </div>
                                    </span>
                                </div>
                                <input type="text" id="telegram-user-id" class="search-input" placeholder="123456789"
                                    style="width: 100%; font-family: var(--font-mono); font-size: 14px;">
                            </div>

                            <!-- Notification Types -->
                            <div style="margin-bottom: 16px;">
                                <label style="display: block; margin-bottom: 12px; color: var(--text-muted); font-size: 13px;">Notification Types</label>
                                <div style="display: flex; flex-direction: column; gap: 10px;">
                                    <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--void); border-radius: 8px; cursor: pointer;">
                                        <input type="checkbox" id="notify-incoming" checked style="width: 18px; height: 18px; accent-color: var(--beam-cyan);">
                                        <div>
                                            <span style="color: var(--text-primary); font-size: 14px;"> Incoming Transactions</span>
                                            <span style="display: block; color: var(--text-muted); font-size: 12px;">Get notified when you receive BEAM or other assets</span>
                                        </div>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--void); border-radius: 8px; cursor: pointer;">
                                        <input type="checkbox" id="notify-p2p-trade" checked style="width: 18px; height: 18px; accent-color: var(--beam-cyan);">
                                        <div>
                                            <span style="color: var(--text-primary); font-size: 14px;"> P2P Trade Updates</span>
                                            <span style="display: block; color: var(--text-muted); font-size: 12px;">Trade accepted, payment sent, payment confirmed, disputes</span>
                                        </div>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--void); border-radius: 8px; cursor: pointer;">
                                        <input type="checkbox" id="notify-escrow" style="width: 18px; height: 18px; accent-color: var(--beam-cyan);">
                                        <div>
                                            <span style="color: var(--text-primary); font-size: 14px;"> Escrow Assignments</span>
                                            <span style="display: block; color: var(--text-muted); font-size: 12px;">Get notified when you're assigned as arbiter in a dispute</span>
                                        </div>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: var(--void); border-radius: 8px; cursor: pointer;">
                                        <input type="checkbox" id="notify-tx-confirmed" style="width: 18px; height: 18px; accent-color: var(--beam-cyan);">
                                        <div>
                                            <span style="color: var(--text-primary); font-size: 14px;"> Transaction Confirmations</span>
                                            <span style="display: block; color: var(--text-muted); font-size: 12px;">Get notified when your sent transactions are confirmed</span>
                                        </div>
                                    </label>
                                </div>
                            </div>

                            <!-- Save & Test Buttons -->
                            <div style="display: flex; gap: 12px;">
                                <button class="quick-btn quick-btn-primary" onclick="saveTelegramSettings()" style="flex: 1;">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                        <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/>
                                        <polyline points="17 21 17 13 7 13 7 21"/>
                                        <polyline points="7 3 7 8 15 8"/>
                                    </svg>
                                    Save Settings
                                </button>
                                <button class="quick-btn quick-btn-secondary" onclick="testTelegramNotification()" style="flex: 1;">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                        <path d="M22 2L11 13"/>
                                        <path d="M22 2L15 22l-4-9-9-4 20-7z"/>
                                    </svg>
                                    Send Test
                                </button>
                            </div>

                            <!-- Status Message -->
                            <div id="telegram-message" style="display: none; margin-top: 12px; padding: 12px; border-radius: 8px; font-size: 13px;"></div>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>

    <!-- Receive Modal -->
    <div class="modal-overlay" id="receive-modal">
        <div class="modal" style="max-width: 520px;">
            <div class="modal-header">
                <h2 class="modal-title">Receive BEAM</h2>
                <button class="modal-close" onclick="closeModal('receive-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <!-- Address Type Selector -->
                <div class="receive-tabs" style="margin-bottom: 16px;">
                    <button class="receive-tab active" onclick="setReceiveType('regular')" data-type="regular">
                        <div class="receive-tab-name">Regular</div>
                        <div class="receive-tab-desc">CEX & Wallets</div>
                    </button>
                    <button class="receive-tab" onclick="setReceiveType('offline')" data-type="offline">
                        <div class="receive-tab-name">Offline</div>
                        <div class="receive-tab-desc">Reusable</div>
                    </button>
                    <button class="receive-tab" onclick="setReceiveType('max_privacy')" data-type="max_privacy">
                        <div class="receive-tab-name">Max Privacy</div>
                        <div class="receive-tab-desc">One-time</div>
                    </button>
                    <button class="receive-tab" onclick="setReceiveType('public_offline')" data-type="public_offline">
                        <div class="receive-tab-name">Donation</div>
                        <div class="receive-tab-desc">Public</div>
                    </button>
                </div>

                <!-- Address Type Description -->
                <div id="address-type-info" style="background: var(--void); padding: 12px; border-radius: 8px; margin-bottom: 16px; font-size: 13px; color: var(--text-secondary);">
                    <strong style="color: var(--beam-cyan);">Regular Address (SBBS)</strong><br>
                    Standard address for exchanges and wallets. Both parties must be online. Expires in 61 days but auto-renews on use.
                </div>

                <!-- Address Options -->
                <div id="address-options" style="display: flex; gap: 12px; margin-bottom: 16px; flex-wrap: wrap;">
                    <!-- Expiration -->
                    <div style="flex: 1; min-width: 140px;">
                        <label style="font-size: 11px; color: var(--text-muted); display: block; margin-bottom: 4px;">Expiration</label>
                        <select id="address-expiration" onchange="regenerateAddress()" style="width: 100%; padding: 8px 12px; background: var(--void); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-size: 13px;">
                            <option value="auto" selected>Auto (61 days)</option>
                            <option value="24h">24 hours</option>
                            <option value="never">Never expires</option>
                        </select>
                    </div>
                    <!-- Offline Payments (only for offline type) -->
                    <div id="offline-payments-option" style="flex: 1; min-width: 140px; display: none;">
                        <label style="font-size: 11px; color: var(--text-muted); display: block; margin-bottom: 4px;">Offline Payments</label>
                        <select id="offline-payments-count" onchange="regenerateAddress()" style="width: 100%; padding: 8px 12px; background: var(--void); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-size: 13px;">
                            <option value="1" selected>1 payment</option>
                            <option value="10">10 payments</option>
                            <option value="50">50 payments</option>
                            <option value="100">100 payments</option>
                        </select>
                    </div>
                </div>

                <!-- Comment -->
                <div style="margin-bottom: 16px;">
                    <label style="font-size: 11px; color: var(--text-muted); display: block; margin-bottom: 4px;">Comment (optional)</label>
                    <input type="text" id="address-comment" placeholder="e.g., Payment from John" onchange="regenerateAddress()" style="width: 100%; padding: 8px 12px; background: var(--void); border: 1px solid var(--border); border-radius: 6px; color: var(--text); font-size: 13px; box-sizing: border-box;">
                </div>

                <!-- QR Code -->
                <div class="qr-container" id="receive-qr" style="margin-bottom: 16px;">
                    <!-- QR Code generated here -->
                </div>

                <!-- Main Address -->
                <div class="address-field" style="margin-bottom: 12px;">
                    <div class="address-label" style="display: flex; justify-content: space-between; align-items: center;">
                        <span>
                            <span id="address-type-label">Address</span>
                            <span class="address-hint" style="margin-left: 8px;">Share this to receive funds</span>
                        </span>
                        <button class="address-copy" onclick="copyAddress('receive-address')" style="padding: 4px 8px; font-size: 11px; display: flex; align-items: center; gap: 4px;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12">
                                <rect x="9" y="9" width="13" height="13" rx="2"/>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                            </svg>
                            Copy
                        </button>
                    </div>
                    <div class="address-value" style="word-break: break-all; font-family: 'JetBrains Mono', monospace; font-size: 11px; padding: 12px; background: var(--void); border-radius: 8px; line-height: 1.5;">
                        <span id="receive-address">Generating...</span>
                    </div>
                </div>

                <!-- SBBS Address (for Regular type) -->
                <div class="address-field" id="sbbs-field" style="margin-bottom: 12px;">
                    <div class="address-label" style="display: flex; justify-content: space-between; align-items: center;">
                        <span>
                            SBBS (Hex Format)
                            <span class="address-hint" style="margin-left: 8px;">Legacy format for some exchanges</span>
                        </span>
                        <button class="address-copy" onclick="copyAddress('receive-sbbs')" style="padding: 4px 8px; font-size: 11px; display: flex; align-items: center; gap: 4px;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12">
                                <rect x="9" y="9" width="13" height="13" rx="2"/>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                            </svg>
                            Copy
                        </button>
                    </div>
                    <div class="address-value" style="word-break: break-all; font-family: 'JetBrains Mono', monospace; font-size: 11px; padding: 12px; background: var(--void); border-radius: 8px; line-height: 1.5;">
                        <span id="receive-sbbs">-</span>
                    </div>
                </div>

                <!-- Signature/Identity -->
                <div class="address-field" id="signature-field">
                    <div class="address-label" style="display: flex; justify-content: space-between; align-items: center;">
                        <span>
                            Identity (Signature)
                            <span class="address-hint" style="margin-left: 8px;">Wallet verification</span>
                        </span>
                        <button class="address-copy" onclick="copyAddress('receive-signature')" style="padding: 4px 8px; font-size: 11px; display: flex; align-items: center; gap: 4px;">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="12" height="12">
                                <rect x="9" y="9" width="13" height="13" rx="2"/>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                            </svg>
                            Copy
                        </button>
                    </div>
                    <div class="address-value" style="word-break: break-all; font-family: 'JetBrains Mono', monospace; font-size: 11px; padding: 12px; background: var(--void); border-radius: 8px; line-height: 1.5;">
                        <span id="receive-signature">-</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('receive-modal')">Close</button>
                <button class="modal-btn modal-btn-primary" onclick="copyAllAndClose()">Copy Address & Close</button>
            </div>
        </div>
    </div>

    <!-- Send Modal -->
    <div class="modal-overlay" id="send-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Send</h2>
                <button class="modal-close" onclick="closeModal('send-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="address-field">
                    <div class="address-label">Recipient Address</div>
                    <input type="text" class="search-input" style="width: 100%;" id="send-address" placeholder="Enter BEAM address">
                </div>
                <div class="address-field">
                    <div class="address-label">Amount</div>
                    <input type="text" inputmode="decimal" class="search-input" style="width: 100%;" id="send-amount" placeholder="0.00" oninput="sanitizeNumericInput(this)">
                </div>
                <div class="address-field">
                    <div class="address-label">Comment (optional)</div>
                    <input type="text" class="search-input" style="width: 100%;" id="send-comment" placeholder="Add a note">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('send-modal')">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="confirmSend()">Send</button>
            </div>
        </div>
    </div>

    <!-- Send Confirmation Modal -->
    <div class="modal-overlay" id="send-confirm-modal">
        <div class="modal" style="max-width: 420px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Transaction</h2>
                <button class="modal-close" onclick="closeModal('send-confirm-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-swap-container" id="send-confirm-content">
                    <!-- Filled dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Swap Confirmation Modal -->
    <div class="modal-overlay" id="swap-confirm-modal">
        <div class="modal" style="max-width: 420px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Swap</h2>
                <button class="modal-close" onclick="closeModal('swap-confirm-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-swap-container" id="swap-confirm-content">
                    <!-- Filled dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Token Selector Modal -->
    <div class="modal-overlay" id="token-select-modal">
        <div class="modal" style="max-width:400px;">
            <div class="modal-header">
                <h2 class="modal-title">Select Token</h2>
                <button class="modal-close" onclick="closeModal('token-select-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding:0;">
                <div style="padding:16px;">
                    <input type="text" class="search-input" id="token-search-input" placeholder="Search by name, symbol or ID..." oninput="renderTokenList()" style="width:100%;">
                </div>
                <div id="token-select-list" style="max-height:400px;overflow-y:auto;padding:0 16px 16px;">
                    <!-- Token list filled by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Liquidity Modal -->
    <div class="modal-overlay" id="liquidity-modal">
        <div class="modal" style="max-width:450px;">
            <div class="modal-header">
                <h2 class="modal-title" id="liquidity-modal-title">Add Liquidity</h2>
                <button class="modal-close" onclick="closeModal('liquidity-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <!-- Pool Info -->
                <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px;padding:16px;background:var(--void);border-radius:10px;">
                    <div id="liq-pool-icons" style="display:flex;"></div>
                    <div>
                        <div id="liq-pool-name" style="font-weight:600;font-size:16px;">-</div>
                        <div id="liq-pool-fee" style="font-size:12px;color:var(--text-muted);">Fee: 0.3%</div>
                    </div>
                </div>

                <!-- Add Liquidity Panel -->
                <div id="liq-add-panel">
                    <div style="margin-bottom:16px;">
                        <label style="display:block;margin-bottom:8px;font-size:13px;color:var(--text-muted);">
                            <span id="liq-asset1-label">Asset 1</span> Amount
                        </label>
                        <input type="text" inputmode="decimal" id="liq-amount1" class="search-input" placeholder="0.0" style="width:100%;" oninput="sanitizeNumericInput(this); calculateLiquidityRatio()">
                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">
                            Balance: <span id="liq-balance1">0</span>
                        </div>
                    </div>
                    <div style="margin-bottom:16px;">
                        <label style="display:block;margin-bottom:8px;font-size:13px;color:var(--text-muted);">
                            <span id="liq-asset2-label">Asset 2</span> Amount
                        </label>
                        <input type="text" inputmode="decimal" id="liq-amount2" class="search-input" placeholder="0.0" style="width:100%;" oninput="sanitizeNumericInput(this); calculateLiquidityRatio()">
                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">
                            Balance: <span id="liq-balance2">0</span>
                        </div>
                    </div>
                    <div id="liq-add-info" style="display:none;background:var(--void);padding:12px;border-radius:8px;margin-bottom:16px;font-size:13px;">
                        <div style="display:flex;justify-content:space-between;margin-bottom:6px;">
                            <span style="color:var(--text-muted);">Pool Rate</span>
                            <span id="liq-rate" style="font-family:'JetBrains Mono',monospace;">-</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;">
                            <span style="color:var(--text-muted);">LP Tokens Est.</span>
                            <span id="liq-lp-estimate" style="font-family:'JetBrains Mono',monospace;">-</span>
                        </div>
                    </div>
                    <button class="quick-btn quick-btn-primary" id="liq-add-btn" onclick="addLiquidity()" style="width:100%;padding:14px;" disabled>
                        Enter amounts
                    </button>
                </div>

                <!-- Remove Liquidity Panel -->
                <div id="liq-remove-panel" style="display:none;">
                    <div style="margin-bottom:16px;">
                        <label style="display:block;margin-bottom:8px;font-size:13px;color:var(--text-muted);">
                            LP Tokens to Remove
                        </label>
                        <input type="text" inputmode="decimal" id="liq-remove-amount" class="search-input" placeholder="0.0" style="width:100%;" oninput="sanitizeNumericInput(this)">
                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">
                            Your LP Balance: <span id="liq-lp-balance">0</span>
                        </div>
                    </div>
                    <div style="display:flex;gap:8px;margin-bottom:16px;">
                        <button class="quick-btn" onclick="setRemovePercent(25)" style="flex:1;">25%</button>
                        <button class="quick-btn" onclick="setRemovePercent(50)" style="flex:1;">50%</button>
                        <button class="quick-btn" onclick="setRemovePercent(75)" style="flex:1;">75%</button>
                        <button class="quick-btn" onclick="setRemovePercent(100)" style="flex:1;">MAX</button>
                    </div>
                    <button class="quick-btn quick-btn-danger" id="liq-remove-btn" onclick="removeLiquidity()" style="width:100%;padding:14px;" disabled>
                        Enter amount
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Liquidity Confirmation Modal -->
    <div class="modal-overlay" id="liquidity-confirm-modal">
        <div class="modal" style="max-width: 420px;">
            <div class="modal-header">
                <h2 class="modal-title" id="liq-confirm-title">Confirm Add Liquidity</h2>
                <button class="modal-close" onclick="closeModal('liquidity-confirm-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-swap-container" id="liq-confirm-content">
                    <!-- Filled dynamically -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('liquidity-confirm-modal')">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="executeAddLiquidity()" style="background: linear-gradient(135deg, #25c2a0, #60a5fa);">Confirm Add Liquidity</button>
            </div>
        </div>
    </div>

    <!-- Withdraw Liquidity Confirmation Modal -->
    <div class="modal-overlay" id="withdraw-confirm-modal">
        <div class="modal" style="max-width: 420px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Withdrawal</h2>
                <button class="modal-close" onclick="closeModal('withdraw-confirm-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-swap-container" id="withdraw-confirm-content">
                    <!-- Filled dynamically -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('withdraw-confirm-modal')">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="executeWithdrawLiquidity()" style="background: linear-gradient(135deg, #f59e0b, #ef4444);">Confirm Withdrawal</button>
            </div>
        </div>
    </div>

    <!-- Quick Trade Modal (opens from Dashboard/Assets Trade button) -->
    <div class="modal-overlay" id="quick-trade-modal">
        <div class="modal" style="max-width: 440px;">
            <div class="modal-header">
                <h2 class="modal-title">Quick Trade</h2>
                <button class="modal-close" onclick="closeModal('quick-trade-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- From Token -->
                <div style="margin-bottom: 12px;">
                    <label style="font-size: 12px; color: var(--text-muted); margin-bottom: 4px; display: block;">You Pay</label>
                    <div style="display: flex; gap: 12px; align-items: center; background: var(--bg-tertiary); border-radius: 12px; padding: 12px;">
                        <div id="qt-from-icon" style="width: 36px; height: 36px; border-radius: 50%; background: var(--beam-cyan); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 12px;">BE</div>
                        <div style="flex: 1;">
                            <input type="text" inputmode="decimal" id="qt-from-amount" placeholder="0.0" style="background: transparent; border: none; font-size: 20px; font-weight: 600; width: 100%; color: var(--text-primary);" oninput="sanitizeNumericInput(this); quickTradeGetQuote()">
                            <div style="font-size: 12px; color: var(--text-muted);">Balance: <span id="qt-from-balance">0</span></div>
                        </div>
                        <div id="qt-from-symbol" style="font-weight: 600; padding: 6px 12px; background: var(--glass); border-radius: 8px; cursor: pointer;" onclick="openQuickTradeFromSelector()">BEAM</div>
                    </div>
                </div>

                <!-- Swap Direction -->
                <div style="display: flex; justify-content: center; margin: 8px 0;">
                    <button onclick="quickTradeSwapDirection()" style="background: var(--glass); border: 1px solid var(--glass-border); border-radius: 50%; width: 36px; height: 36px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                            <path d="M7 16V4m0 0L3 8m4-4l4 4M17 8v12m0 0l4-4m-4 4l-4-4"/>
                        </svg>
                    </button>
                </div>

                <!-- To Token -->
                <div style="margin-bottom: 16px;">
                    <label style="font-size: 12px; color: var(--text-muted); margin-bottom: 4px; display: block;">You Receive</label>
                    <div style="display: flex; gap: 12px; align-items: center; background: var(--bg-tertiary); border-radius: 12px; padding: 12px;">
                        <div id="qt-to-icon" style="width: 36px; height: 36px; border-radius: 50%; background: var(--beam-pink); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 12px;">FO</div>
                        <div style="flex: 1;">
                            <div id="qt-to-amount" style="font-size: 20px; font-weight: 600; color: var(--text-primary);">0.0</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Balance: <span id="qt-to-balance">0</span></div>
                        </div>
                        <div id="qt-to-symbol" style="font-weight: 600; padding: 6px 12px; background: var(--glass); border-radius: 8px; cursor: pointer;" onclick="openQuickTradeToSelector()">FOMO</div>
                    </div>
                </div>

                <!-- Rate Info -->
                <div id="qt-rate-info" style="background: var(--bg-tertiary); border-radius: 8px; padding: 12px; font-size: 12px; margin-bottom: 16px; display: none;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                        <span style="color: var(--text-muted);">Rate</span>
                        <span id="qt-rate">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">Pool Fee</span>
                        <span id="qt-fee">0.3%</span>
                    </div>
                </div>

                <!-- Swap Button -->
                <button id="qt-swap-btn" class="quick-btn quick-btn-primary" style="width: 100%; padding: 16px; font-size: 16px;" onclick="executeQuickTrade()" disabled>
                    Enter Amount
                </button>
            </div>
        </div>
    </div>

    <!-- Quick Withdraw LP Modal (opens from Dashboard/Assets Withdraw LP button) -->
    <div class="modal-overlay" id="quick-withdraw-lp-modal">
        <div class="modal" style="max-width: 440px;">
            <div class="modal-header">
                <h2 class="modal-title">Withdraw Liquidity</h2>
                <button class="modal-close" onclick="closeModal('quick-withdraw-lp-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- LP Token Info -->
                <div style="background: var(--bg-tertiary); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
                        <div id="qw-lp-icon" style="width: 44px; height: 44px; border-radius: 50%; background: linear-gradient(135deg, #25c2a0, #60a5fa); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: white;">LP</div>
                        <div>
                            <div id="qw-lp-name" style="font-weight: 600; font-size: 16px;">BEAM/FOMO LP</div>
                            <div style="font-size: 12px; color: var(--text-muted);">Balance: <span id="qw-lp-balance">0</span></div>
                        </div>
                    </div>
                </div>

                <!-- Withdraw Percentage -->
                <div style="margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="font-size: 12px; color: var(--text-muted);">Withdraw Amount</span>
                        <span id="qw-percent" style="font-weight: 600;">50%</span>
                    </div>
                    <input type="range" id="qw-slider" min="1" max="100" value="50" style="width: 100%;" oninput="updateQuickWithdrawAmount()">
                    <div style="display: flex; justify-content: space-between; margin-top: 8px;">
                        <button onclick="setQuickWithdrawPercent(25)" style="padding: 4px 12px; border-radius: 6px; background: var(--glass); border: 1px solid var(--glass-border); cursor: pointer; font-size: 11px;">25%</button>
                        <button onclick="setQuickWithdrawPercent(50)" style="padding: 4px 12px; border-radius: 6px; background: var(--glass); border: 1px solid var(--glass-border); cursor: pointer; font-size: 11px;">50%</button>
                        <button onclick="setQuickWithdrawPercent(75)" style="padding: 4px 12px; border-radius: 6px; background: var(--glass); border: 1px solid var(--glass-border); cursor: pointer; font-size: 11px;">75%</button>
                        <button onclick="setQuickWithdrawPercent(100)" style="padding: 4px 12px; border-radius: 6px; background: var(--glass); border: 1px solid var(--glass-border); cursor: pointer; font-size: 11px;">MAX</button>
                    </div>
                </div>

                <!-- Estimated Receive -->
                <div style="background: var(--bg-tertiary); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 8px;">You'll Receive (Estimated)</div>
                    <div id="qw-receive-amounts">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                            <span id="qw-asset1-symbol">BEAM</span>
                            <span id="qw-asset1-amount" style="color: var(--success);">+0</span>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span id="qw-asset2-symbol">FOMO</span>
                            <span id="qw-asset2-amount" style="color: var(--success);">+0</span>
                        </div>
                    </div>
                </div>

                <!-- Withdraw Button -->
                <button id="qw-withdraw-btn" class="quick-btn quick-btn-danger" style="width: 100%; padding: 16px; font-size: 16px;" onclick="executeQuickWithdrawLP()">
                    Withdraw Liquidity
                </button>
            </div>
        </div>
    </div>

    <!-- Create Token Modal -->
    <div class="modal-overlay" id="create-token-modal">
        <div class="modal" style="max-width: 520px;">
            <div class="modal-header">
                <h2 class="modal-title">Create New Token</h2>
                <button class="modal-close" onclick="closeModal('create-token-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px; max-height: 70vh; overflow-y: auto;">
                <!-- Token Info Section -->
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Token Name *</div>
                    <input type="text" id="ct-name" placeholder="e.g., My Awesome Token" maxlength="64"
                           style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                    <div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Symbol *</div>
                        <input type="text" id="ct-symbol" placeholder="e.g., MAT" maxlength="8"
                               style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px; text-transform: uppercase;">
                    </div>
                    <div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Short Name</div>
                        <input type="text" id="ct-short-name" placeholder="e.g., MAT" maxlength="16"
                               style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
                    <div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Max Supply *</div>
                        <input type="number" id="ct-supply" placeholder="e.g., 1000000" min="1"
                               style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                    </div>
                    <div>
                        <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Decimals</div>
                        <select id="ct-decimals" style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                            <option value="8" selected>8 (like BEAM)</option>
                            <option value="6">6 (like USDC)</option>
                            <option value="2">2 (cents)</option>
                            <option value="0">0 (whole numbers)</option>
                        </select>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Smallest Unit Name</div>
                    <input type="text" id="ct-unit-name" placeholder="e.g., groth (optional)" maxlength="16"
                           style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                </div>

                <div style="margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Logo URL</div>
                    <input type="url" id="ct-logo-url" placeholder="https://example.com/logo.png (optional)"
                           style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                    <div style="font-size: 11px; color: var(--text-muted); margin-top: 4px;">Direct link to token logo image (PNG, SVG, or ICO recommended)</div>
                </div>

                <div style="margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Short Description</div>
                    <input type="text" id="ct-short-desc" placeholder="Brief description (max 128 chars)" maxlength="128"
                           style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px;">
                </div>

                <div style="margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Long Description</div>
                    <textarea id="ct-long-desc" placeholder="Detailed description (optional, max 1024 chars)" maxlength="1024" rows="3"
                              style="width: 100%; padding: 12px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 14px; resize: vertical;"></textarea>
                </div>

                <div style="margin-bottom: 24px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Token Color</div>
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <input type="color" id="ct-color" value="#25c2a0" style="width: 50px; height: 40px; border: none; border-radius: 8px; cursor: pointer;">
                        <input type="text" id="ct-color-hex" value="#25c2a0" maxlength="7" placeholder="#RRGGBB"
                               style="width: 100px; padding: 10px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 13px; font-family: 'JetBrains Mono', monospace;"
                               oninput="syncColorFromHex()">
                        <div id="ct-color-preview" style="flex: 1; height: 40px; border-radius: 8px; background: #25c2a0;"></div>
                    </div>
                </div>

                <!-- Fee Info -->
                <div style="background: var(--void); border-radius: 10px; padding: 16px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span style="color: var(--text-muted); font-size: 13px;">Creation Fee</span>
                        <span style="color: var(--warning); font-weight: 600;">60 BEAM</span>
                    </div>
                    <div style="font-size: 11px; color: var(--text-muted);">
                        This fee is paid to the BEAM network for registering your new Confidential Asset.
                    </div>
                </div>

                <!-- Create Button -->
                <button id="ct-create-btn" class="quick-btn quick-btn-primary" style="width: 100%; padding: 16px; font-size: 16px;" onclick="createToken()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18" style="vertical-align: middle; margin-right: 8px;"><path d="M12 5v14M5 12h14"/></svg>
                    Create Token (60 BEAM)
                </button>
            </div>
        </div>
    </div>

    <!-- Mint Token Modal -->
    <div class="modal-overlay" id="mint-token-modal">
        <div class="modal" style="max-width: 440px;">
            <div class="modal-header">
                <h2 class="modal-title">Mint Tokens</h2>
                <button class="modal-close" onclick="closeModal('mint-token-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- Token Info -->
                <div style="background: var(--bg-tertiary); border-radius: 12px; padding: 16px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div id="mint-token-icon" style="width: 44px; height: 44px; border-radius: 50%; background: var(--beam-cyan); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: white;">TK</div>
                        <div style="flex: 1;">
                            <div id="mint-token-name" style="font-weight: 600; font-size: 16px;">Token Name</div>
                            <div style="font-size: 12px; color: var(--text-muted);">
                                Remaining: <span id="mint-remaining" style="color: var(--beam-cyan);">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Amount Input -->
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Amount to Mint</div>
                    <input type="number" id="mint-amount" placeholder="Enter amount" min="0" step="any"
                           style="width: 100%; padding: 14px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 16px;">
                    <div style="display: flex; gap: 8px; margin-top: 8px;">
                        <button class="quick-amount-btn" onclick="setMintPercent(25)">25%</button>
                        <button class="quick-amount-btn" onclick="setMintPercent(50)">50%</button>
                        <button class="quick-amount-btn" onclick="setMintPercent(75)">75%</button>
                        <button class="quick-amount-btn" onclick="setMintPercent(100)">MAX</button>
                    </div>
                </div>

                <!-- Mint Button -->
                <button id="mint-btn" class="quick-btn quick-btn-primary" style="width: 100%; padding: 16px; font-size: 16px;" onclick="executeMintToken()">
                    Mint Tokens
                </button>
            </div>
        </div>
    </div>

    <!-- Burn Token Modal -->
    <div class="modal-overlay" id="burn-token-modal">
        <div class="modal" style="max-width: 440px;">
            <div class="modal-header">
                <h2 class="modal-title" style="color: #ef4444;"> Burn Tokens</h2>
                <button class="modal-close" onclick="closeModal('burn-token-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- Token Info -->
                <div style="background: var(--bg-tertiary); border-radius: 12px; padding: 16px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 12px;">
                        <div id="burn-token-icon" style="width: 44px; height: 44px; border-radius: 50%; background: var(--error); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: white;">TK</div>
                        <div style="flex: 1;">
                            <div id="burn-token-name" style="font-weight: 600; font-size: 16px;">Token Name</div>
                            <div style="font-size: 12px; color: var(--text-muted);">
                                Balance: <span id="burn-balance" style="color: var(--success);">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Warning -->
                <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 12px; margin-bottom: 20px;">
                    <div style="display: flex; gap: 8px; align-items: flex-start;">
                        <span style="color: #ef4444;"></span>
                        <div style="font-size: 12px; color: var(--text-secondary);">
                            <strong style="color: #ef4444;">Warning:</strong> Burning tokens is permanent and irreversible. The tokens will be destroyed and cannot be recovered.
                        </div>
                    </div>
                </div>

                <!-- Amount Input -->
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 12px; color: var(--text-muted); margin-bottom: 6px;">Amount to Burn</div>
                    <input type="number" id="burn-amount" placeholder="Enter amount" min="0" step="any"
                           style="width: 100%; padding: 14px; background: var(--void); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 16px;">
                    <div style="display: flex; gap: 8px; margin-top: 8px;">
                        <button class="quick-amount-btn" onclick="setBurnPercent(25)">25%</button>
                        <button class="quick-amount-btn" onclick="setBurnPercent(50)">50%</button>
                        <button class="quick-amount-btn" onclick="setBurnPercent(75)">75%</button>
                        <button class="quick-amount-btn" onclick="setBurnPercent(100)">MAX</button>
                    </div>
                </div>

                <!-- Burn Button -->
                <button id="burn-btn" class="quick-btn" style="width: 100%; padding: 16px; font-size: 16px; background: linear-gradient(135deg, #ef4444, #f97316); color: white;" onclick="executeBurnToken()">
                     Burn Tokens
                </button>
            </div>
        </div>
    </div>

    <!-- Address Type Info Modal -->
    <div class="modal-overlay" id="address-info-modal">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h2 class="modal-title" id="address-info-title">Address Information</h2>
                <button class="modal-close" onclick="closeModal('address-info-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" id="address-info-content">
                <!-- Dynamic content -->
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('address-info-modal')">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="closeModal('address-info-modal'); generateAddress()">Create Address</button>
            </div>
        </div>
    </div>

    <!-- Split UTXOs Modal -->
    <div class="modal-overlay" id="split-utxo-modal">
        <div class="modal" style="max-width: 480px;">
            <div class="modal-header">
                <h2 class="modal-title">Split Coins</h2>
                <button class="modal-close" onclick="closeModal('split-utxo-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div id="split-asset-info"></div>
                <div id="split-current-utxos" style="margin-bottom:16px;"></div>
                <div id="split-count-selector" style="margin-bottom:16px;"></div>
                <div id="split-preview" style="margin-bottom:16px;"></div>
                <div id="split-fee-info" style="background:var(--void-light);border-radius:8px;padding:12px;margin-bottom:16px;"></div>
                <div class="split-info-box">
                    Splitting creates multiple independent coins. Each coin can be spent separately, so you can send several transactions without waiting for confirmations (~60 sec each).
                </div>
                <button id="split-execute-btn" class="quick-btn quick-btn-primary" style="width:100%;padding:14px;font-size:15px;margin-top:16px;" onclick="executeSplit()">
                    Split into 5 coins
                </button>
                <div id="split-progress" style="display:none;margin-top:16px;">
                    <div class="split-progress-bar">
                        <div class="split-progress-fill" id="split-progress-fill"></div>
                    </div>
                    <div class="split-progress-text" id="split-progress-text">Splitting...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Combine UTXOs Modal -->
    <div class="modal-overlay" id="combine-utxo-modal">
        <div class="modal" style="max-width: 480px;">
            <div class="modal-header">
                <h2 class="modal-title">Combine Coins</h2>
                <button class="modal-close" onclick="closeModal('combine-utxo-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div id="combine-asset-info"></div>
                <div id="combine-current-utxos" style="margin-bottom:16px;"></div>
                <div id="combine-preview" style="margin-bottom:16px;"></div>
                <div id="combine-fee-info" style="background:var(--void-light);border-radius:8px;padding:12px;margin-bottom:16px;"></div>
                <div class="split-info-box">
                    Combining merges all your small coins into one large coin. This cleans up dust and makes your full balance available in a single UTXO.
                </div>
                <button id="combine-execute-btn" class="quick-btn quick-btn-primary" style="width:100%;padding:14px;font-size:15px;margin-top:16px;" onclick="executeCombine()">
                    Combine into 1 coin
                </button>
                <div id="combine-progress" style="display:none;margin-top:16px;">
                    <div class="split-progress-bar">
                        <div class="split-progress-fill" id="combine-progress-fill"></div>
                    </div>
                    <div class="split-progress-text" id="combine-progress-text">Combining...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- First-time Guide -->
    <div class="guide-overlay" id="guide-overlay">
        <div class="guide-card">
            <div class="guide-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4M12 8h.01"/>
                </svg>
            </div>
            <h2 class="guide-title">Welcome to BEAM Wallet</h2>
            <p class="guide-text">
                BEAM is a privacy-focused cryptocurrency. Your transactions are confidential by default, meaning nobody can see your balance or transaction history on the blockchain.
                <br><br>
                Look for the <strong style="color: var(--beam-cyan);">?</strong> icons throughout the app to learn more about each feature.
            </p>
            <button class="guide-btn" onclick="closeGuide()">Get Started</button>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- beam-wallet.js provides BeamWallet namespace but we use inline API calls -->
    <!-- <script src="js/beam-wallet.js"></script> -->
    <!-- wallet-app.js has different HTML structure, don't include it -->
    <!-- <script src="js/wallet-app.js"></script> -->
    <!-- JavaScript -->
    <script src="/js/pages/fuddle.js"></script>
    <script src="/js/app.js"></script>

    <!-- Modal Container -->
    <div id="modal-container"></div>
</body>
</html>
