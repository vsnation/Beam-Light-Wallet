</head>
<body>
    <!-- Background Effects -->
    <div class="bg-effects">
        <div class="bg-gradient bg-gradient-1"></div>
        <div class="bg-gradient bg-gradient-2"></div>
    </div>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-logo">
                <svg viewBox="0 0 40 40" fill="none">
                    <circle cx="20" cy="20" r="18" stroke="url(#logo-gradient)" stroke-width="2" fill="none"/>
                    <path d="M12 20L18 26L28 14" stroke="url(#logo-gradient)" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    <defs>
                        <linearGradient id="logo-gradient" x1="0" y1="0" x2="40" y2="40">
                            <stop offset="0%" stop-color="#25c2a0"/>
                            <stop offset="100%" stop-color="#00d4ff"/>
                        </linearGradient>
                    </defs>
                </svg>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-item active" data-page="dashboard" data-tooltip="Dashboard">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="9" rx="1"/>
                        <rect x="14" y="3" width="7" height="5" rx="1"/>
                        <rect x="14" y="12" width="7" height="9" rx="1"/>
                        <rect x="3" y="16" width="7" height="5" rx="1"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="assets" data-tooltip="Assets">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v12M6 12h12"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="transactions" data-tooltip="Transactions">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2v20M17 7l-5-5-5 5M7 17l5 5 5-5"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="addresses" data-tooltip="Addresses">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/>
                        <circle cx="12" cy="10" r="3"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="dex" data-tooltip="DEX Trading">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 3h5v5M4 20L21 3M21 16v5h-5M15 15l6 6M4 4l5 5"/>
                    </svg>
                </div>
                <div class="nav-item" data-page="settings" data-tooltip="Settings">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M12 1v4M12 19v4M4.2 4.2l2.8 2.8M17 17l2.8 2.8M1 12h4M19 12h4M4.2 19.8l2.8-2.8M17 7l2.8-2.8"/>
                    </svg>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="nav-item" data-tooltip="Help & Guide" onclick="showGuide()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9 9a3 3 0 015.12 2.13c0 2-3 3-3 3M12 17h.01"/>
                    </svg>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <h1 class="page-title" id="page-title">Dashboard</h1>
                    <div class="network-badge">
                        <span>Mainnet</span>
                    </div>
                </div>
                <div class="header-right">
                    <button class="header-btn" onclick="openReceiveModal()" title="Receive">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14M19 12l-7 7-7-7"/>
                        </svg>
                    </button>
                    <button class="header-btn" title="Notifications">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/>
                        </svg>
                    </button>
                    <button class="header-btn" id="lock-btn" title="Lock Wallet" onclick="lockWallet()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="11" width="18" height="11" rx="2"/>
                            <path d="M7 11V7a5 5 0 0110 0v4"/>
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Content -->
            <div class="content">
                <!-- Dashboard Page -->
                <div class="page active" id="page-dashboard">
                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <button class="quick-btn quick-btn-primary" onclick="openSendModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 19V5M5 12l7-7 7 7"/>
                            </svg>
                            Send
                        </button>
                        <button class="quick-btn quick-btn-secondary" onclick="openReceiveModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 5v14M19 12l-7 7-7-7"/>
                            </svg>
                            Receive
                        </button>
                        <button class="quick-btn quick-btn-secondary" onclick="App.showPage('dex')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M16 3h5v5M4 20L21 3M21 16v5h-5"/>
                            </svg>
                            Swap
                        </button>
                    </div>

                    <!-- Assets Section -->
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">
                                Assets
                                <div class="info-trigger">
                                    ?
                                    <div class="info-panel">
                                        <div class="info-panel-title">What are Confidential Assets?</div>
                                        <div class="info-panel-text">
                                            Confidential Assets (CAs) are custom tokens on the BEAM blockchain. They inherit BEAM's privacy features, meaning all transactions are private by default. Anyone can create a CA for various purposes like tokens, stablecoins, or NFTs.
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="view-toggle">
                                <span>Selected</span>
                                <div class="toggle-switch active" id="asset-toggle" onclick="toggleAssetView()"></div>
                                <span>All</span>
                            </div>
                        </div>

                        <div class="asset-cards-container">
                            <div class="asset-cards-scroll" id="asset-cards">
                                <!-- Filled by JS -->
                            </div>
                        </div>
                    </section>

                    <!-- Balances Table Section -->
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">
                                Balances
                                <div class="info-trigger">
                                    ?
                                    <div class="info-panel">
                                        <div class="info-panel-title">Understanding Your Balance</div>
                                        <div class="info-panel-text">
                                            <strong>Available:</strong> Funds you can spend right now.<br><br>
                                            <strong>Locked:</strong> Funds in pending transactions or maturing. They'll become available automatically.
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="balances-card">
                            <div class="balances-header">
                                <input type="text" class="search-input" id="balance-search" placeholder="Search assets..." oninput="filterBalances()">
                            </div>
                            <table class="balances-table">
                                <thead>
                                    <tr>
                                        <th onclick="sortBalances('name')">Asset <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></th>
                                        <th onclick="sortBalances('balance')">Balance <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg></th>
                                        <th onclick="sortBalances('locked')">Locked</th>
                                        <th>Asset ID</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="balances-tbody">
                                    <!-- Filled by JS -->
                                </tbody>
                            </table>
                        </div>

                        <!-- UTXO Section -->
                        <button class="utxo-toggle" id="utxo-toggle" onclick="toggleUtxo()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                <path d="M6 9l6 6 6-6"/>
                            </svg>
                            Show UTXOs (Advanced)
                            <div class="info-trigger" style="margin-left: auto;">
                                ?
                                <div class="info-panel" style="right: 0; left: auto; transform: none;">
                                    <div class="info-panel-title">What is a UTXO?</div>
                                    <div class="info-panel-text">
                                        UTXO stands for "Unspent Transaction Output". Think of UTXOs like individual bills in your physical wallet - each one has a specific value. When you spend, UTXOs are combined and split as needed, just like using cash.
                                    </div>
                                </div>
                            </div>
                        </button>

                        <div class="utxo-panel" id="utxo-panel">
                            <table class="utxo-table">
                                <thead>
                                    <tr>
                                        <th>Coin</th>
                                        <th>Maturity</th>
                                        <th>Type</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="utxo-tbody">
                                    <!-- Filled by JS -->
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- Assets Page -->
                <div class="page" id="page-assets">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">All Blockchain Assets</div>
                        </div>
                        <div class="balances-card">
                            <div class="balances-header" style="display:flex;gap:16px;align-items:center;flex-wrap:wrap;">
                                <input type="text" class="search-input" id="all-assets-search" placeholder="Search all assets on BEAM..." style="flex:1;min-width:200px;">
                                <label style="display:flex;align-items:center;gap:8px;cursor:pointer;font-size:13px;color:var(--text-secondary);">
                                    <input type="checkbox" id="show-hidden-assets" onchange="toggleShowHidden()">
                                    Show hidden assets
                                </label>
                            </div>
                            <table class="balances-table">
                                <thead>
                                    <tr>
                                        <th>Asset</th>
                                        <th>Your Balance</th>
                                        <th>Asset ID</th>
                                        <th>Total Supply</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="all-assets-tbody">
                                    <!-- Filled by JS -->
                                </tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- Transactions Page -->
                <div class="page" id="page-transactions">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">Transaction History</div>
                        </div>
                        <div id="transactions-list">
                            <div class="empty-state">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2v20M17 7l-5-5-5 5M7 17l5 5 5-5"/>
                                </svg>
                                <h3>No transactions yet</h3>
                                <p>Your transaction history will appear here</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Addresses Page -->
                <div class="page" id="page-addresses">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">Your Addresses</div>
                            <button class="quick-btn quick-btn-primary" onclick="generateNewAddress()">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
                                    <path d="M12 5v14M5 12h14"/>
                                </svg>
                                New Address
                            </button>
                        </div>
                        <div id="addresses-list" class="balances-card">
                            <!-- Filled by JS -->
                        </div>
                    </section>
                </div>

                <!-- DEX Page -->
                <div class="page" id="page-dex">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">DEX Trading</div>
                            <div style="display:flex;gap:8px;">
                                <button class="quick-btn dex-tab active" data-dex-tab="swap" onclick="showDexTab('swap')">Swap</button>
                                <button class="quick-btn dex-tab" data-dex-tab="pools" onclick="showDexTab('pools')">Pools</button>
                                <button class="quick-btn dex-tab" data-dex-tab="liquidity" onclick="showDexTab('liquidity')">Liquidity</button>
                            </div>
                        </div>

                        <!-- Swap Tab -->
                        <div class="dex-panel active" id="dex-swap">
                            <div class="balances-card" style="max-width:480px;margin:0 auto;padding:24px;">
                                <h3 style="margin-bottom:20px;text-align:center;">Swap Tokens</h3>

                                <!-- From Token -->
                                <div class="swap-input-group" style="margin-bottom:8px;">
                                    <label style="font-size:12px;color:var(--text-muted);margin-bottom:4px;display:block;">You Pay</label>
                                    <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                        <input type="number" id="dex-from-amount" class="swap-amount-input" placeholder="0.0" oninput="debounceGetQuote()">
                                        <button class="token-select-btn" id="dex-from-token" onclick="openTokenSelector('from')">
                                            <div class="token-icon-small" id="dex-from-icon" style="background:var(--beam-cyan);">BE</div>
                                            <span id="dex-from-symbol">BEAM</span>
                                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                                        </button>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;">
                                        <div style="font-size:11px;color:var(--text-muted);">Balance: <span id="dex-from-balance">0</span></div>
                                        <div class="quick-amount-btns" style="display:flex;gap:4px;">
                                            <button class="quick-amount-btn" onclick="setQuickAmount(0.1)">0.1</button>
                                            <button class="quick-amount-btn" onclick="setQuickAmount(0.5)">0.5</button>
                                            <button class="quick-amount-btn" onclick="setQuickAmount(1)">1</button>
                                            <button class="quick-amount-btn" onclick="setQuickAmount('max')">MAX</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Swap Direction Button -->
                                <div style="text-align:center;margin:12px 0;">
                                    <button class="swap-direction-btn" onclick="swapDirection()" style="background:var(--void-lighter);border:2px solid var(--glass-border);border-radius:50%;width:40px;height:40px;cursor:pointer;">
                                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="var(--beam-cyan)" stroke-width="2"><path d="M7 16V4M7 4L3 8M7 4l4 4M17 8v12M17 20l4-4M17 20l-4-4"/></svg>
                                    </button>
                                </div>

                                <!-- To Token -->
                                <div class="swap-input-group" style="margin-bottom:16px;">
                                    <label style="font-size:12px;color:var(--text-muted);margin-bottom:4px;display:block;">You Receive</label>
                                    <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                        <input type="number" id="dex-to-amount" class="swap-amount-input" placeholder="0.0" readonly>
                                        <button class="token-select-btn" id="dex-to-token" onclick="openTokenSelector('to')">
                                            <div class="token-icon-small" id="dex-to-icon" style="background:var(--beam-pink);">?</div>
                                            <span id="dex-to-symbol">Select</span>
                                            <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 9l6 6 6-6"/></svg>
                                        </button>
                                    </div>
                                </div>

                                <!-- Swap Info - matches AllDapps -->
                                <div id="dex-swap-info" style="display:none;background:var(--void);border-radius:10px;padding:16px;margin-bottom:16px;font-size:13px;border:1px solid var(--glass-border);">
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">Exchange Rate</span>
                                        <span id="dex-rate" style="font-family:'JetBrains Mono',monospace;">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">You Pay</span>
                                        <span id="dex-pay" style="font-family:'JetBrains Mono',monospace;color:var(--error);">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">You Receive</span>
                                        <span id="dex-receive" style="font-family:'JetBrains Mono',monospace;color:var(--success);">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;margin-bottom:10px;">
                                        <span style="color:var(--text-muted);">Pool Fee (0.3%)</span>
                                        <span id="dex-fee" style="font-family:'JetBrains Mono',monospace;">-</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;">
                                        <span style="color:var(--text-muted);">Min. Received</span>
                                        <span id="dex-min-receive" style="font-family:'JetBrains Mono',monospace;">-</span>
                                    </div>
                                </div>

                                <!-- Swap Button -->
                                <button class="quick-btn quick-btn-primary" id="dex-swap-btn" onclick="executeSwap()" style="width:100%;padding:16px;font-size:16px;" disabled>
                                    Select tokens
                                </button>
                            </div>
                        </div>

                        <!-- Pools Tab -->
                        <div class="dex-panel" id="dex-pools">
                            <div id="pools-list" class="pools-grid">
                                <div style="text-align:center;padding:32px;color:var(--text-muted);">Loading pools...</div>
                            </div>
                        </div>

                        <!-- Liquidity Tab -->
                        <div class="dex-panel" id="dex-liquidity">
                            <!-- Liquidity Mode Tabs -->
                            <div style="display:flex;gap:8px;margin-bottom:20px;justify-content:center;">
                                <button class="quick-btn liq-mode-btn active" data-liq-mode="add" onclick="switchLiqMode('add')">Add Liquidity</button>
                                <button class="quick-btn liq-mode-btn" data-liq-mode="withdraw" onclick="switchLiqMode('withdraw')">Withdraw</button>
                            </div>

                            <!-- Add Liquidity Panel -->
                            <div class="liq-panel active" id="liq-add-panel">
                                <div class="balances-card" style="max-width:480px;margin:0 auto;padding:24px;">
                                    <h3 style="margin-bottom:8px;text-align:center;">Add Liquidity</h3>
                                    <p style="text-align:center;color:var(--text-muted);font-size:12px;margin-bottom:20px;">Provide liquidity to earn trading fees</p>

                                    <!-- Pool Selector -->
                                    <div class="swap-input-group" style="margin-bottom:16px;">
                                        <label style="font-size:12px;color:var(--text-muted);">Select Pool</label>
                                        <select id="liq-pool-select" class="search-input" style="width:100%;padding:12px;cursor:pointer;" onchange="onPoolSelect()">
                                            <option value="">-- Select a pool --</option>
                                        </select>
                                    </div>

                                    <div class="swap-input-group" style="margin-bottom:12px;">
                                        <label style="font-size:12px;color:var(--text-muted);">Token A Amount</label>
                                        <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                            <input type="number" id="liq-amount-a" class="swap-amount-input" placeholder="0.0" oninput="calcLiquidityB()">
                                            <div class="token-select-btn" id="liq-token-a" style="cursor:default;">
                                                <div class="token-icon-small" id="liq-icon-a" style="background:var(--beam-cyan);">BE</div>
                                                <span id="liq-symbol-a">BEAM</span>
                                            </div>
                                        </div>
                                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Balance: <span id="liq-balance-a">0</span></div>
                                    </div>

                                    <div style="text-align:center;margin:8px 0;color:var(--text-muted);">+</div>

                                    <div class="swap-input-group" style="margin-bottom:16px;">
                                        <label style="font-size:12px;color:var(--text-muted);">Token B Amount</label>
                                        <div style="display:flex;background:var(--void);border-radius:12px;padding:12px;">
                                            <input type="number" id="liq-amount-b" class="swap-amount-input" placeholder="0.0" oninput="calcLiquidityA()">
                                            <div class="token-select-btn" id="liq-token-b" style="cursor:default;">
                                                <div class="token-icon-small" id="liq-icon-b" style="background:var(--beam-pink);">FO</div>
                                                <span id="liq-symbol-b">FOMO</span>
                                            </div>
                                        </div>
                                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">Balance: <span id="liq-balance-b">0</span></div>
                                    </div>

                                    <!-- Pool Info -->
                                    <div id="liq-pool-info" style="display:none;background:var(--void);border-radius:8px;padding:12px;margin-bottom:16px;font-size:13px;">
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="color:var(--text-muted);">Pool Rate</span>
                                            <span id="liq-rate">-</span>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="color:var(--text-muted);">Your Share</span>
                                            <span id="liq-share">-</span>
                                        </div>
                                        <div style="display:flex;justify-content:space-between;">
                                            <span style="color:var(--text-muted);">LP Tokens</span>
                                            <span id="liq-lp-tokens">-</span>
                                        </div>
                                    </div>

                                    <button class="quick-btn quick-btn-primary" id="add-liq-btn" onclick="executeAddLiquidity()" style="width:100%;padding:16px;" disabled>
                                        Select Pool
                                    </button>
                                </div>
                            </div>

                            <!-- Withdraw Liquidity Panel -->
                            <div class="liq-panel" id="liq-withdraw-panel">
                                <div class="balances-card" style="max-width:480px;margin:0 auto;padding:24px;">
                                    <h3 style="margin-bottom:8px;text-align:center;">Withdraw Liquidity</h3>
                                    <p style="text-align:center;color:var(--text-muted);font-size:12px;margin-bottom:20px;">Remove your liquidity from a pool</p>

                                    <!-- Your LP Positions -->
                                    <div id="lp-positions" style="margin-bottom:20px;">
                                        <div style="text-align:center;padding:24px;color:var(--text-muted);">Loading your LP positions...</div>
                                    </div>

                                    <!-- Withdraw Amount -->
                                    <div id="withdraw-form" style="display:none;">
                                        <div class="swap-input-group" style="margin-bottom:16px;">
                                            <label style="font-size:12px;color:var(--text-muted);">Withdraw Percentage</label>
                                            <div style="display:flex;gap:8px;margin-top:8px;">
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(25)">25%</button>
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(50)">50%</button>
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(75)">75%</button>
                                                <button class="quick-amount-btn" onclick="setWithdrawPercent(100)">100%</button>
                                            </div>
                                            <input type="range" id="withdraw-slider" min="0" max="100" value="100" style="width:100%;margin-top:12px;" oninput="updateWithdrawAmount()">
                                            <div style="text-align:center;font-size:24px;font-weight:600;margin-top:8px;"><span id="withdraw-percent">100</span>%</div>
                                        </div>

                                        <div id="withdraw-preview" style="background:var(--void);border-radius:8px;padding:12px;margin-bottom:16px;font-size:13px;">
                                            <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                                <span style="color:var(--text-muted);">You'll Receive</span>
                                            </div>
                                            <div id="withdraw-amounts" style="font-weight:500;">-</div>
                                        </div>

                                        <button class="quick-btn quick-btn-primary" id="withdraw-liq-btn" onclick="executeWithdrawLiquidity()" style="width:100%;padding:16px;">
                                            Withdraw Liquidity
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Settings Page -->
                <div class="page" id="page-settings">
                    <section class="section">
                        <div class="section-header">
                            <div class="section-title">Settings</div>
                        </div>

                        <!-- Connection Status -->
                        <div class="balances-card" style="padding: 24px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <h3>Connection Status</h3>
                                <span id="live-indicator" class="live-indicator">
                                    <span class="live-dot"></span>
                                    LIVE
                                </span>
                            </div>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Status</span>
                                    <span id="settings-status">Checking...</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Block Height</span>
                                    <span id="settings-height" class="mono-text">-</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Network</span>
                                    <span>Mainnet</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Last Updated</span>
                                    <span id="settings-last-update" class="mono-text">-</span>
                                </div>
                            </div>
                        </div>

                        <!-- Node Configuration -->
                        <div class="balances-card" style="padding: 24px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                                <h3>Node Configuration</h3>
                                <span class="info-trigger">?
                                    <div class="info-panel">
                                        <div class="info-panel-title">Node Types</div>
                                        <div class="info-panel-text">
                                            <strong>Public Node:</strong> Fast connection, no setup required. Use for everyday transactions.<br><br>
                                            <strong>Local Node (fast_sync):</strong> Better privacy, DEX shader support. Required for swaps. Takes time to sync initially.
                                        </div>
                                    </div>
                                </span>
                            </div>

                            <!-- Node Type Selector -->
                            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                                <button class="node-type-btn active" id="node-public-btn" onclick="selectNodeType('public', true)">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                        <circle cx="12" cy="12" r="10"/>
                                        <path d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/>
                                    </svg>
                                    <span>Public Node</span>
                                </button>
                                <button class="node-type-btn" id="node-local-btn" onclick="selectNodeType('local', true)">
                                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                        <rect x="2" y="3" width="20" height="14" rx="2"/>
                                        <path d="M8 21h8M12 17v4"/>
                                    </svg>
                                    <span>Local Node</span>
                                </button>
                            </div>

                            <!-- Current Node Info -->
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Current Node</span>
                                    <span id="settings-node" class="mono-text" style="font-size: 12px;">eu-node01.mainnet.beam.mw:8100</span>
                                </div>
                                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">Node Type</span>
                                    <span id="settings-node-type">Public</span>
                                </div>
                            </div>

                            <!-- Local Node Sync Progress -->
                            <div id="local-node-section" style="margin-top: 16px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                                    <span style="color: var(--text-secondary); font-size: 14px; font-weight: 500;">Local Node</span>
                                    <div style="display: flex; gap: 8px;">
                                        <button class="quick-btn" onclick="startLocalNode()" style="padding: 4px 12px; font-size: 12px;">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                                <polygon points="5 3 19 12 5 21 5 3"/>
                                            </svg>
                                            Start
                                        </button>
                                        <button class="quick-btn" onclick="stopLocalNode()" style="padding: 4px 12px; font-size: 12px;">
                                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                                <rect x="6" y="6" width="12" height="12"/>
                                            </svg>
                                            Stop
                                        </button>
                                    </div>
                                </div>
                                <div style="padding: 16px; background: var(--void); border-radius: 10px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <span style="color: var(--text-muted); font-size: 13px;">Sync Progress</span>
                                        <span id="sync-percentage" style="color: var(--beam-cyan); font-weight: 600; font-size: 15px;">0%</span>
                                    </div>
                                    <div class="sync-progress-bar">
                                        <div class="sync-progress-fill" id="sync-progress-fill" style="width: 0%;"></div>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin-top: 10px; font-size: 12px;">
                                        <span id="sync-status-text" style="color: var(--text-muted);">Waiting...</span>
                                        <span id="sync-blocks" style="color: var(--text-muted);">0 / 0 headers</span>
                                    </div>
                                </div>
                                <p style="margin-top: 12px; font-size: 12px; color: var(--text-muted);">
                                    Running a local node enables DEX features and provides better privacy.
                                    Initial sync downloads ~3.7GB of blockchain headers.
                                </p>
                            </div>

                            <!-- Node Selection Dropdown -->
                            <div style="margin-top: 16px;">
                                <label style="display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 13px;">Select Node</label>
                                <select id="node-selector" class="search-input" style="width: 100%; cursor: pointer;" onchange="changeNode()">
                                    <option value="eu-node01.mainnet.beam.mw:8100">EU Node 1 (Primary)</option>
                                    <option value="eu-node02.mainnet.beam.mw:8100">EU Node 2</option>
                                    <option value="us-node01.mainnet.beam.mw:8100">US Node 1</option>
                                    <option value="us-node02.mainnet.beam.mw:8100">US Node 2</option>
                                    <option value="ap-node01.mainnet.beam.mw:8100">Asia Pacific Node</option>
                                    <option value="127.0.0.1:10005">Local Node (127.0.0.1:10005)</option>
                                </select>
                            </div>

                            <!-- Reconnect Button -->
                            <button class="quick-btn quick-btn-secondary" style="width: 100%; margin-top: 16px;" onclick="reconnectNode()" id="reconnect-btn">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                                    <path d="M23 4v6h-6M1 20v-6h6"/>
                                    <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
                                </svg>
                                Reconnect to Node
                            </button>
                        </div>

                        <!-- DEX Support Info -->
                        <div class="balances-card" style="padding: 24px;">
                            <h3 style="margin-bottom: 16px;">DEX & Shaders</h3>
                            <div style="display: flex; flex-direction: column; gap: 12px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: var(--void); border-radius: 8px;">
                                    <span style="color: var(--text-muted);">DEX Support</span>
                                    <span id="dex-support-status" style="display: flex; align-items: center; gap: 6px;">
                                        <span class="status-dot status-checking"></span>
                                        Checking...
                                    </span>
                                </div>
                                <div style="padding: 12px; background: var(--warning-dim); border-radius: 8px; display: none;" id="dex-warning">
                                    <div style="display: flex; align-items: start; gap: 8px;">
                                        <svg viewBox="0 0 24 24" fill="none" stroke="var(--warning)" stroke-width="2" width="18" height="18" style="flex-shrink: 0; margin-top: 2px;">
                                            <circle cx="12" cy="12" r="10"/>
                                            <path d="M12 8v4M12 16h.01"/>
                                        </svg>
                                        <span style="color: var(--warning); font-size: 13px;">
                                            Public nodes don't support DEX shaders. Switch to a local node to use swap functionality.
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </main>
    </div>

    <!-- Receive Modal -->
    <div class="modal-overlay" id="receive-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Receive</h2>
                <button class="modal-close" onclick="closeModal('receive-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="receive-tabs">
                    <button class="receive-tab active" onclick="setReceiveType('regular')">
                        <div class="receive-tab-name">SBBS</div>
                        <div class="receive-tab-desc">For CEX & wallets</div>
                    </button>
                    <button class="receive-tab" onclick="setReceiveType('offline')">
                        <div class="receive-tab-name">Offline</div>
                        <div class="receive-tab-desc">One-time use</div>
                    </button>
                    <button class="receive-tab" onclick="setReceiveType('max_privacy')">
                        <div class="receive-tab-name">Max Privacy</div>
                        <div class="receive-tab-desc">Shielded</div>
                    </button>
                </div>

                <div class="qr-container" id="receive-qr">
                    <!-- QR Code generated here -->
                </div>

                <div class="address-field">
                    <div class="address-label">
                        Address
                        <span class="address-hint">Share this to receive funds</span>
                    </div>
                    <div class="address-value">
                        <span id="receive-address">Generating...</span>
                        <button class="address-copy" onclick="copyAddress('receive-address')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                <rect x="9" y="9" width="13" height="13" rx="2"/>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="address-field" id="sbbs-field">
                    <div class="address-label">
                        SBBS Address
                        <span class="address-hint">For CEX withdrawals</span>
                    </div>
                    <div class="address-value">
                        <span id="receive-sbbs">-</span>
                        <button class="address-copy" onclick="copyAddress('receive-sbbs')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                <rect x="9" y="9" width="13" height="13" rx="2"/>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="address-field">
                    <div class="address-label">Signature</div>
                    <div class="address-value">
                        <span id="receive-signature">-</span>
                        <button class="address-copy" onclick="copyAddress('receive-signature')">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14">
                                <rect x="9" y="9" width="13" height="13" rx="2"/>
                                <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('receive-modal')">Close</button>
                <button class="modal-btn modal-btn-primary" onclick="copyAllAndClose()">Copy Address & Close</button>
            </div>
        </div>
    </div>

    <!-- Send Modal -->
    <div class="modal-overlay" id="send-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Send</h2>
                <button class="modal-close" onclick="closeModal('send-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="address-field">
                    <div class="address-label">Recipient Address</div>
                    <input type="text" class="search-input" style="width: 100%;" id="send-address" placeholder="Enter BEAM address">
                </div>
                <div class="address-field">
                    <div class="address-label">Amount</div>
                    <input type="number" class="search-input" style="width: 100%;" id="send-amount" placeholder="0.00">
                </div>
                <div class="address-field">
                    <div class="address-label">Comment (optional)</div>
                    <input type="text" class="search-input" style="width: 100%;" id="send-comment" placeholder="Add a note">
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-secondary" onclick="closeModal('send-modal')">Cancel</button>
                <button class="modal-btn modal-btn-primary" onclick="confirmSend()">Send</button>
            </div>
        </div>
    </div>

    <!-- Swap Confirmation Modal -->
    <div class="modal-overlay" id="swap-confirm-modal">
        <div class="modal" style="max-width: 420px;">
            <div class="modal-header">
                <h2 class="modal-title">Confirm Swap</h2>
                <button class="modal-close" onclick="closeModal('swap-confirm-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="confirm-swap-container" id="swap-confirm-content">
                    <!-- Filled dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Token Selector Modal -->
    <div class="modal-overlay" id="token-select-modal">
        <div class="modal" style="max-width:400px;">
            <div class="modal-header">
                <h2 class="modal-title">Select Token</h2>
                <button class="modal-close" onclick="closeModal('token-select-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body" style="padding:0;">
                <div style="padding:16px;">
                    <input type="text" class="search-input" id="token-search-input" placeholder="Search by name, symbol or ID..." oninput="renderTokenList()" style="width:100%;">
                </div>
                <div id="token-select-list" style="max-height:400px;overflow-y:auto;padding:0 16px 16px;">
                    <!-- Token list filled by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Liquidity Modal -->
    <div class="modal-overlay" id="liquidity-modal">
        <div class="modal" style="max-width:450px;">
            <div class="modal-header">
                <h2 class="modal-title" id="liquidity-modal-title">Add Liquidity</h2>
                <button class="modal-close" onclick="closeModal('liquidity-modal')">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <!-- Pool Info -->
                <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px;padding:16px;background:var(--void);border-radius:10px;">
                    <div id="liq-pool-icons" style="display:flex;"></div>
                    <div>
                        <div id="liq-pool-name" style="font-weight:600;font-size:16px;">-</div>
                        <div id="liq-pool-fee" style="font-size:12px;color:var(--text-muted);">Fee: 0.3%</div>
                    </div>
                </div>

                <!-- Add Liquidity Panel -->
                <div id="liq-add-panel">
                    <div style="margin-bottom:16px;">
                        <label style="display:block;margin-bottom:8px;font-size:13px;color:var(--text-muted);">
                            <span id="liq-asset1-label">Asset 1</span> Amount
                        </label>
                        <input type="number" id="liq-amount1" class="search-input" placeholder="0.0" style="width:100%;" oninput="calculateLiquidityRatio()">
                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">
                            Balance: <span id="liq-balance1">0</span>
                        </div>
                    </div>
                    <div style="margin-bottom:16px;">
                        <label style="display:block;margin-bottom:8px;font-size:13px;color:var(--text-muted);">
                            <span id="liq-asset2-label">Asset 2</span> Amount
                        </label>
                        <input type="number" id="liq-amount2" class="search-input" placeholder="0.0" style="width:100%;" oninput="calculateLiquidityRatio()">
                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">
                            Balance: <span id="liq-balance2">0</span>
                        </div>
                    </div>
                    <div id="liq-add-info" style="display:none;background:var(--void);padding:12px;border-radius:8px;margin-bottom:16px;font-size:13px;">
                        <div style="display:flex;justify-content:space-between;margin-bottom:6px;">
                            <span style="color:var(--text-muted);">Pool Rate</span>
                            <span id="liq-rate" style="font-family:'JetBrains Mono',monospace;">-</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;">
                            <span style="color:var(--text-muted);">LP Tokens Est.</span>
                            <span id="liq-lp-estimate" style="font-family:'JetBrains Mono',monospace;">-</span>
                        </div>
                    </div>
                    <button class="quick-btn quick-btn-primary" id="liq-add-btn" onclick="addLiquidity()" style="width:100%;padding:14px;" disabled>
                        Enter amounts
                    </button>
                </div>

                <!-- Remove Liquidity Panel -->
                <div id="liq-remove-panel" style="display:none;">
                    <div style="margin-bottom:16px;">
                        <label style="display:block;margin-bottom:8px;font-size:13px;color:var(--text-muted);">
                            LP Tokens to Remove
                        </label>
                        <input type="number" id="liq-remove-amount" class="search-input" placeholder="0.0" style="width:100%;">
                        <div style="font-size:11px;color:var(--text-muted);margin-top:4px;">
                            Your LP Balance: <span id="liq-lp-balance">0</span>
                        </div>
                    </div>
                    <div style="display:flex;gap:8px;margin-bottom:16px;">
                        <button class="quick-btn" onclick="setRemovePercent(25)" style="flex:1;">25%</button>
                        <button class="quick-btn" onclick="setRemovePercent(50)" style="flex:1;">50%</button>
                        <button class="quick-btn" onclick="setRemovePercent(75)" style="flex:1;">75%</button>
                        <button class="quick-btn" onclick="setRemovePercent(100)" style="flex:1;">MAX</button>
                    </div>
                    <button class="quick-btn quick-btn-primary" id="liq-remove-btn" onclick="removeLiquidity()" style="width:100%;padding:14px;background:var(--error);" disabled>
                        Enter amount
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- First-time Guide -->
    <div class="guide-overlay" id="guide-overlay">
        <div class="guide-card">
            <div class="guide-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 16v-4M12 8h.01"/>
                </svg>
            </div>
            <h2 class="guide-title">Welcome to BEAM Wallet</h2>
            <p class="guide-text">
                BEAM is a privacy-focused cryptocurrency. Your transactions are confidential by default, meaning nobody can see your balance or transaction history on the blockchain.
                <br><br>
                Look for the <strong style="color: var(--beam-cyan);">?</strong> icons throughout the app to learn more about each feature.
            </p>
            <button class="guide-btn" onclick="closeGuide()">Get Started</button>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- beam-wallet.js provides BeamWallet namespace but we use inline API calls -->
